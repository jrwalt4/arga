(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.arga=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var CommandBuilderBase=function(){function CommandBuilderBase(){}return CommandBuilderBase}();module.exports=CommandBuilderBase},{}],2:[function(require,module,exports){"use strict";exports.DataSet=require("./core/DataSet");exports.DataTable=require("./core/DataTable");exports.DataView=require("./core/DataView");exports.DataRow=require("./core/DataRow");exports.DataRowCollection=require("./core/DataRowCollection");exports.DataRowVersion=require("./core/DataRowVersion");exports.DataRowState=require("./core/DataRowState");exports.DataColumn=require("./core/DataColumn");exports.DataColumnConstraint=require("./core/DataColumnConstraint");exports.DataColumnCollection=require("./core/DataColumnCollection");exports.DataRelation=require("./core/DataRelation");exports.util=require("./core/Util");exports.CommandBuilderBase=require("./adapter/CommandBuilderBase")},{"./adapter/CommandBuilderBase":1,"./core/DataColumn":3,"./core/DataColumnCollection":4,"./core/DataColumnConstraint":5,"./core/DataRelation":6,"./core/DataRow":7,"./core/DataRowCollection":8,"./core/DataRowState":9,"./core/DataRowVersion":10,"./core/DataSet":11,"./core/DataTable":12,"./core/DataView":13,"./core/Util":14}],3:[function(require,module,exports){"use strict";var SortedArray=require("collections/sorted-array");var util=require("./Util");var DataTable=require("./DataTable");var DataColumn=function(){function DataColumn(table,name,keyPath){if(!(table instanceof DataTable)){throw new Error("cannot construct DataColumn without DataTable")}this._name=name;this._keyPath=keyPath;this._index=new SortedArray(undefined,util.createContentEquator(keyPath),util.createContentComparer(keyPath))}DataColumn.prototype.getValue=function(object){return util.resolveKeyPath(this._keyPath,object)};DataColumn.prototype.table=function(){return this._table};DataColumn.prototype.name=function(sName){if(sName!==undefined){this._name=sName;return this}return this._name};DataColumn.prototype.keyPath=function(){if(this._keyPath===void 0){return this.name()}return this._keyPath};return DataColumn}();var Item=function(){function Item(key,index){this.key=key;this.index=index}return Item}();module.exports=DataColumn},{"./DataTable":12,"./Util":14,"collections/sorted-array":33}],4:[function(require,module,exports){"use strict";var DataColumnCollection=function(){function DataColumnCollection(dataTable){if(dataTable===void 0){throw new Error("Illegal DataColumnCollection constructor: expected DataTable as first argument")}this._table=dataTable;this._columns=new Array}DataColumnCollection.prototype.add=function(dataColumn){if(this._columns.indexOf(dataColumn)<0){this._columns.push(dataColumn)}else{throw new Error("Column '"+dataColumn.name()+"' already exists in collection")}return this};DataColumnCollection.prototype.get=function(col){if(typeof col==="string"){for(var _i=0,_a=this._columns;_i<_a.length;_i++){var dc=_a[_i];if(dc.name()===col){return dc}}}};DataColumnCollection.prototype.remove=function(col){};return DataColumnCollection}();module.exports=DataColumnCollection},{}],5:[function(require,module,exports){"use strict";var DataColumnConstraint;(function(DataColumnConstraint){DataColumnConstraint[DataColumnConstraint["PRIMARY_KEY"]=0]="PRIMARY_KEY";DataColumnConstraint[DataColumnConstraint["UNIQUE"]=1]="UNIQUE";DataColumnConstraint[DataColumnConstraint["INDEX"]=2]="INDEX"})(DataColumnConstraint||(DataColumnConstraint={}));module.exports=DataColumnConstraint},{}],6:[function(require,module,exports){"use strict";var DataRelation=function(){function DataRelation(_parent,_child,_operator){this._parent=_parent;this._child=_child;this._operator=_operator}return DataRelation}();module.exports=DataRelation},{}],7:[function(require,module,exports){"use strict";var DataTable=require("./DataTable");var DataRowState=require("./DataRowState");var DataRowVersion=require("./DataRowVersion");var DataRow=function(){function DataRow(dataTable){if(!(dataTable instanceof DataTable)){throw new Error("Cannot construct DataRow without DataTable")}this._table=dataTable;this._original={};this._current=this._createCurrent();this._proposed=this._createProposed()}DataRow.prototype._createCurrent=function(){return Object.create(this._original)};DataRow.prototype._createProposed=function(){if(this._current==void 0){throw new Error("DataRow._current has been deleted")}return Object.create(this._current)};DataRow.prototype.get=function(key,version){return this._getItem(key,version)};DataRow.prototype.set=function(key,newValue,version){return this._setItem(key,newValue,version)};DataRow.prototype.del=function(key){this._setItem(key,null)};DataRow.prototype.has=function(key){return Object.keys(this._current).indexOf(key)>=0||Object.keys(this._original).indexOf(key)>=0};DataRow.prototype.delete=function(version){if(this.isEditing()){this._proposed=null}else{this._current=null}};DataRow.prototype.item=function(key,newValue,version){if(newValue!==undefined){return this._setItem(key,newValue,version)}else{return this._getItem(key,version)}};DataRow.prototype._getItem=function(key,version){var column=this._getColumn(key);if(column===void 0){return this._getVersion(version)[key]}else{return column.getValue(this._getVersion(version))}};DataRow.prototype._setItem=function(column,newValue,version){if(this.rowState()==DataRowState.DELETED){throw new Error("Row already deleted")}this._getVersion(version)[column]=newValue;return this};DataRow.prototype._getVersion=function(version){version=version||DataRowVersion.DEFAULT;switch(version){case DataRowVersion.DEFAULT:if(this.isEditing()){return this._proposed}else{return this._current}case DataRowVersion.CURRENT:return this._current;case DataRowVersion.ORIGINAL:return this._original;case DataRowVersion.PROPOSED:return this._proposed;default:throw new Error("DataRowVersion {"+version+"} is not recognized")}};DataRow.prototype._getColumn=function(name){return this.table().columns().get(name)};DataRow.prototype.table=function(oDataTable){if(oDataTable!==undefined){if(oDataTable===null){this._table=undefined}else{this._table=oDataTable}return this}return this._table};DataRow.prototype.rowState=function(){if(this._current===null){return DataRowState.DELETED}if(Object.keys(this._current).length===0){return DataRowState.UNCHANGED}if(this._table===undefined){return DataRowState.DETACHED}return DataRowState.MODIFIED};DataRow.prototype.beginEdit=function(){if(this.isEditing()){throw new Error("already editing")}this._proposed=this._createProposed()};DataRow.prototype.isEditing=function(){return!!this._proposed};DataRow.prototype.endEdit=function(){this.dispatchBeforeRowChange();var self=this;Object.keys(this._proposed).forEach(function(key){self._current[key]=self._proposed[key]});delete this._proposed;this.dispatchRowChange()};DataRow.prototype.acceptChanges=function(){var self=this;Object.keys(this._current).forEach(function(key,i){var value=self._current[key];if(value===null){delete self._original[key]}else{self._original[key]=self._current[key]}});this._current=this._createCurrent()};DataRow.prototype.rejectChanges=function(){this._current=this._createCurrent()};DataRow.prototype.dispatchRowChange=function(){};DataRow.prototype.dispatchBeforeRowChange=function(){};return DataRow}();module.exports=DataRow},{"./DataRowState":9,"./DataRowVersion":10,"./DataTable":12}],8:[function(require,module,exports){"use strict";var SortedArray=require("collections/sorted-array");var DataRowCollection=function(){function DataRowCollection(dataTable){if(dataTable===void 0){throw new Error("Illegal DataRowCollection constructor: expected DataTable as first argument")}this._table=dataTable;this._rows=new SortedArray}DataRowCollection.prototype.add=function(){var rows=[];for(var _i=0;_i<arguments.length;_i++){rows[_i-0]=arguments[_i]}this._rows.addEach(rows)};DataRowCollection.prototype.toArray=function(){return this._rows.toArray()};return DataRowCollection}();module.exports=DataRowCollection},{"collections/sorted-array":33}],9:[function(require,module,exports){"use strict";var DataRowState;(function(DataRowState){DataRowState[DataRowState["DETACHED"]=1]="DETACHED";DataRowState[DataRowState["UNCHANGED"]=2]="UNCHANGED";DataRowState[DataRowState["ADDED"]=4]="ADDED";DataRowState[DataRowState["MODIFIED"]=8]="MODIFIED";DataRowState[DataRowState["DELETED"]=16]="DELETED"})(DataRowState||(DataRowState={}));module.exports=DataRowState},{}],10:[function(require,module,exports){"use strict";var DataRowVersion;(function(DataRowVersion){DataRowVersion[DataRowVersion["ORIGINAL"]=0]="ORIGINAL";DataRowVersion[DataRowVersion["CURRENT"]=1]="CURRENT";DataRowVersion[DataRowVersion["PROPOSED"]=2]="PROPOSED";DataRowVersion[DataRowVersion["DEFAULT"]=3]="DEFAULT"})(DataRowVersion||(DataRowVersion={}));module.exports=DataRowVersion},{}],11:[function(require,module,exports){"use strict";var DataTable=require("./DataTable");var ds_counter=0;var DataSet=function(){function DataSet(name){if(name===void 0){name="Set"+ds_counter++}this._name=name;this._tables=[];this._relations=[]}DataSet.prototype.tables=function(){return this._tables.slice()};DataSet.prototype.addTable=function(oTable){var tbl;if(typeof oTable==="string"){tbl=new DataTable(oTable)}else{tbl=oTable}if(tbl.name()===undefined){tbl.name("Table"+this._tables.length)}this._tables.push(tbl)};DataSet.prototype.acceptChanges=function(){this._tables.forEach(function(table){table.acceptChanges()})};DataSet.prototype.getChanges=function(){};DataSet.prototype.name=function(newValue){if(newValue!=undefined){this._name=newValue}return this._name};return DataSet}();module.exports=DataSet},{"./DataTable":12}],12:[function(require,module,exports){"use strict";var DataColumnCollection=require("./DataColumnCollection");var DataRowCollection=require("./DataRowCollection");var Util_1=require("./Util");var dt_counter=0;var DataTable=function(){function DataTable(sName,sKeyPath){this._name=sName||"Table"+dt_counter++;this._rows=new DataRowCollection(this);this._columns=new DataColumnCollection(this);this._keyPath=sKeyPath;this._keyComparer=Util_1.createContentComparer(sKeyPath)}DataTable.prototype.name=function(sName){if(sName!==undefined){this._name=sName;return this}return this._name};DataTable.prototype.rows=function(){return this._rows};DataTable.prototype.columns=function(){return this._columns};DataTable.prototype.keyPath=function(){return this._keyPath};DataTable.prototype.acceptChanges=function(){this._rows.toArray().forEach(function(dr){dr.acceptChanges()})};return DataTable}();console.log("loaded DataTable");module.exports=DataTable},{"./DataColumnCollection":4,"./DataRowCollection":8,"./Util":14}],13:[function(require,module,exports){"use strict";var DataView=function(){function DataView(){}return DataView}();module.exports=DataView},{}],14:[function(require,module,exports){"use strict";function createContentComparer(sKeyPath){return function compare(objA,objB){var keyA=resolveKeyPath(sKeyPath,objA);var keyB=resolveKeyPath(sKeyPath,objB);return keyA<keyB?-1:keyA>keyB?1:0}}exports.createContentComparer=createContentComparer;function createContentEquator(sKeyPath){return function equals(objA,objB){var keyA=resolveKeyPath(sKeyPath,objA);var keyB=resolveKeyPath(sKeyPath,objB);return keyA==keyB}}exports.createContentEquator=createContentEquator;function compareKeys(keyA,keyB){if(indexedDB!==void 0){return indexedDB.cmp(keyA,keyB)}else{return keyA<keyB?-1:keyA>keyB?1:0}}exports.compareKeys=compareKeys;function resolveKeyPath(sKeyPath,obj){sKeyPath=sKeyPath||"";var path=sKeyPath.split(".");return path.reduce(function(prevResult,nextVal){if(prevResult===void 0){return void 0}return prevResult[nextVal]},obj)}exports.resolveKeyPath=resolveKeyPath;function createValueWithKeyPath(value,sKeyPath){var keyPathArray=sKeyPath.split(".");return keyPathArray.reduceRight(function(prevValue,key,curIndex,array){var wrappedValue={};wrappedValue[key]=prevValue;return wrappedValue},value)}exports.createValueWithKeyPath=createValueWithKeyPath},{}],15:[function(require,module,exports){"use strict";var Shim=require("./shim");var GenericCollection=require("./generic-collection");var GenericMap=require("./generic-map");module.exports=Dict;function Dict(values,getDefault){if(!(this instanceof Dict)){return new Dict(values,getDefault)}getDefault=getDefault||Function.noop;this.getDefault=getDefault;this.store=Object.create(null);this.length=0;this.addEach(values)}Dict.Dict=Dict;Object.addEach(Dict.prototype,GenericCollection.prototype);Object.addEach(Dict.prototype,GenericMap.prototype);Dict.from=GenericCollection.from;Dict.prototype.constructClone=function(values){return new this.constructor(values,this.getDefault)};Dict.prototype.assertString=function(key){if(typeof key!=="string"){throw new TypeError("key must be a string but Got "+key)}};Object.defineProperty(Dict.prototype,"$__proto__",{writable:true});Object.defineProperty(Dict.prototype,"_hasProto",{get:function(){return this.hasOwnProperty("$__proto__")&&typeof this._protoValue!=="undefined"}});Object.defineProperty(Dict.prototype,"_protoValue",{get:function(){return this["$__proto__"]},set:function(value){this["$__proto__"]=value}});Object.defineProperty(Dict.prototype,"size",GenericCollection._sizePropertyDescriptor);Dict.prototype.get=function(key,defaultValue){this.assertString(key);if(key==="__proto__"){if(this._hasProto){return this._protoValue}else if(arguments.length>1){return defaultValue}else{return this.getDefault(key)}}else{if(key in this.store){return this.store[key]}else if(arguments.length>1){return defaultValue}else{return this.getDefault(key)}}};Dict.prototype.set=function(key,value){this.assertString(key);var isProtoKey=key==="__proto__";if(isProtoKey?this._hasProto:key in this.store){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,isProtoKey?this._protoValue:this.store[key])}isProtoKey?this._protoValue=value:this.store[key]=value;if(this.dispatchesMapChanges){this.dispatchMapChange(key,value)}return false}else{if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,undefined)}this.length++;isProtoKey?this._protoValue=value:this.store[key]=value;if(this.dispatchesMapChanges){this.dispatchMapChange(key,value)}return true}};Dict.prototype.has=function(key){this.assertString(key);return key==="__proto__"?this._hasProto:key in this.store};Dict.prototype["delete"]=function(key){this.assertString(key);if(key==="__proto__"){if(this._hasProto){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,this._protoValue)}this._protoValue=undefined;this.length--;if(this.dispatchesMapChanges){this.dispatchMapChange(key,undefined)}return true}return false}else{if(key in this.store){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,this.store[key])}delete this.store[key];this.length--;if(this.dispatchesMapChanges){this.dispatchMapChange(key,undefined)}return true}return false}};Dict.prototype.clear=function(){var key;if(this._hasProto){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange("__proto__",this._protoValue)}this._protoValue=undefined;if(this.dispatchesMapChanges){this.dispatchMapChange("__proto__",undefined)}}for(key in this.store){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,this.store[key])}delete this.store[key];if(this.dispatchesMapChanges){this.dispatchMapChange(key,undefined)}}this.length=0};Dict.prototype.reduce=function(callback,basis,thisp){if(this._hasProto){basis=callback.call(thisp,basis,"$__proto__","__proto__",this)}var store=this.store;for(var key in this.store){basis=callback.call(thisp,basis,store[key],key,this)}return basis};Dict.prototype.reduceRight=function(callback,basis,thisp){var self=this;var store=this.store;basis=Object.keys(this.store).reduceRight(function(basis,key){return callback.call(thisp,basis,store[key],key,self)},basis);if(this._hasProto){return callback.call(thisp,basis,this._protoValue,"__proto__",self)}return basis};Dict.prototype.one=function(){var key;for(key in this.store){return this.store[key]}return this._protoValue};Dict.prototype.toJSON=function(){return this.toObject()}},{"./generic-collection":20,"./generic-map":21,"./shim":32}],16:[function(require,module,exports){"use strict";var Shim=require("./shim");var Dict=require("./_dict");var List=require("./_list");var GenericCollection=require("./generic-collection");var GenericSet=require("./generic-set");var TreeLog=require("./tree-log");var object_has=Object.prototype.hasOwnProperty;module.exports=FastSet;function FastSet(values,equals,hash,getDefault){if(!(this instanceof FastSet)){return new FastSet(values,equals,hash,getDefault)}equals=equals||Object.equals;hash=hash||Object.hash;getDefault=getDefault||Function.noop;this.contentEquals=equals;this.contentHash=hash;this.getDefault=getDefault;var self=this;this.buckets=new this.Buckets(null,function getDefaultBucket(){return new self.Bucket});this.length=0;this.addEach(values)}FastSet.FastSet=FastSet;Object.addEach(FastSet.prototype,GenericCollection.prototype);Object.addEach(FastSet.prototype,GenericSet.prototype);FastSet.from=GenericCollection.from;FastSet.prototype.Buckets=Dict;FastSet.prototype.Bucket=List;FastSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)};FastSet.prototype.has=function(value){var hash=this.contentHash(value);return this.buckets.get(hash).has(value)};FastSet.prototype.get=function(value,equals){if(equals){throw new Error("FastSet#get does not support second argument: equals")}var hash=this.contentHash(value);var buckets=this.buckets;if(buckets.has(hash)){return buckets.get(hash).get(value)}else{return this.getDefault(value)}};FastSet.prototype["delete"]=function(value,equals){if(equals){throw new Error("FastSet#delete does not support second argument: equals")}var hash=this.contentHash(value);var buckets=this.buckets;if(buckets.has(hash)){var bucket=buckets.get(hash);if(bucket["delete"](value)){this.length--;if(bucket.length===0){buckets["delete"](hash)}return true}}return false};FastSet.prototype.clear=function(){this.buckets.clear();this.length=0};FastSet.prototype.add=function(value){var hash=this.contentHash(value);var buckets=this.buckets;if(!buckets.has(hash)){buckets.set(hash,new this.Bucket(null,this.contentEquals))}if(!buckets.get(hash).has(value)){buckets.get(hash).add(value);this.length++;return true}return false};FastSet.prototype.reduce=function(callback,basis){var thisp=arguments[2];var buckets=this.buckets;var index=0;return buckets.reduce(function(basis,bucket){return bucket.reduce(function(basis,value){return callback.call(thisp,basis,value,index++,this)},basis,this)},basis,this)};FastSet.prototype.one=function(){if(this.length>0){return this.buckets.one().one()}};FastSet.prototype.iterate=function(){return this.buckets.valuesArray().flatten().iterate()};FastSet.prototype.log=function(charmap,logNode,callback,thisp){charmap=charmap||TreeLog.unicodeSharp;logNode=logNode||this.logNode;if(!callback){callback=console.log;thisp=console}callback=callback.bind(thisp);var buckets=this.buckets,bucketsSize=buckets.size,mapIter=buckets.keys(),hash,index=0,branch,leader,bucket;while(hash=mapIter.next().value){if(index===bucketsSize-1){branch=charmap.fromAbove;leader=" "}else if(index===0){branch=charmap.branchDown;leader=charmap.strafe}else{branch=charmap.fromBoth;leader=charmap.strafe}bucket=buckets.get(hash);callback.call(thisp,branch+charmap.through+charmap.branchDown+" "+hash);bucket.forEach(function(value,node){var branch,below,written;if(node===bucket.head.prev){branch=charmap.fromAbove;below=" "}else{branch=charmap.fromBoth;below=charmap.strafe}logNode(node,function(line){if(!written){callback.call(thisp,leader+" "+branch+charmap.through+charmap.through+line);written=true}else{callback.call(thisp,leader+" "+below+"  "+line)}},function(line){callback.call(thisp,leader+" "+charmap.strafe+"  "+line)})});index++}};FastSet.prototype.logNode=function(node,write){var value=node.value;if(Object(value)===value){JSON.stringify(value,null,4).split("\n").forEach(function(line){write(" "+line)})}else{write(" "+value)}}},{"./_dict":15,"./_list":17,"./generic-collection":20,"./generic-set":23,"./shim":32,"./tree-log":34}],17:[function(require,module,exports){"use strict";module.exports=List;var Shim=require("./shim");var GenericCollection=require("./generic-collection");var GenericOrder=require("./generic-order");function List(values,equals,getDefault){return List._init(List,this,values,equals,getDefault)}List._init=function(constructor,object,values,equals,getDefault){if(!(object instanceof constructor)){return new constructor(values,equals,getDefault)}var head=object.head=new object.Node;head.next=head;head.prev=head;object.contentEquals=equals||Object.equals;object.getDefault=getDefault||Function.noop;object.length=0;object.addEach(values)};List.List=List;Object.addEach(List.prototype,GenericCollection.prototype);Object.addEach(List.prototype,GenericOrder.prototype);List.from=GenericCollection.from;List.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.getDefault)};List.prototype.find=function(value,equals,index){equals=equals||this.contentEquals;var head=this.head;var at=this.scan(index,head.next);while(at!==head){if(equals(at.value,value)){return at}at=at.next}};List.prototype.findLast=function(value,equals,index){equals=equals||this.contentEquals;var head=this.head;var at=this.scan(index,head.prev);while(at!==head){if(equals(at.value,value)){return at}at=at.prev}};List.prototype.has=function(value,equals){return!!this.find(value,equals)};List.prototype.get=function(value,equals){var found=this.find(value,equals);if(found){return found.value}return this.getDefault(value)};List.prototype["delete"]=function(value,equals){var found=this.findLast(value,equals);if(found){found["delete"]();this.length--;return true}return false};List.prototype.deleteAll=function(value,equals){equals=equals||this.contentEquals;var head=this.head;var at=head.next;var count=0;while(at!==head){if(equals(value,at.value)){at["delete"]();count++}at=at.next}this.length-=count;return count};List.prototype.clear=function(){this.head.next=this.head.prev=this.head;this.length=0};List.prototype.add=function(value){var node=new this.Node(value);return this._addNode(node)};List.prototype._addNode=function(node){this.head.addBefore(node);this.length++;return true};List.prototype.push=function(){var head=this.head;for(var i=0;i<arguments.length;i++){var value=arguments[i];var node=new this.Node(value);head.addBefore(node)}this.length+=arguments.length};List.prototype.unshift=function(){var at=this.head;for(var i=0;i<arguments.length;i++){var value=arguments[i];var node=new this.Node(value);at.addAfter(node);at=node}this.length+=arguments.length};List.prototype._shouldPop=function(){var value;var head=this.head;if(head.prev!==head){value=head.prev.value}return value};List.prototype.pop=function(_before,_after){var value;var head=this.head;if(head.prev!==head){value=head.prev.value;var index=this.length-1;var popDispatchValueArray=_before?_before.call(this,value,index):void 0;head.prev["delete"]();this.length--;_after?_after.call(this,value,index,popDispatchValueArray):void 0}return value};List.prototype.shift=function(_before,_after){var value;var head=this.head;if(head.prev!==head){value=head.next.value;var dispatchValueArray=_before?_before.call(this,value,0):void 0;head.next["delete"]();this.length--;_after?_after.call(this,value,0,dispatchValueArray):void 0}return value};List.prototype.peek=function(){if(this.head!==this.head.next){return this.head.next.value}};List.prototype.poke=function(value){if(this.head!==this.head.next){this.head.next.value=value}else{this.push(value)}};List.prototype.one=function(){return this.peek()};List.prototype.scan=function(at,fallback){var head=this.head;if(typeof at==="number"){var count=at;if(count>=0){at=head.next;while(count){count--;at=at.next;if(at==head){break}}}else{at=head;while(count<0){count++;at=at.prev;if(at==head){break}}}return at}else{return at||fallback}};List.prototype.slice=function(at,end){var sliced=[];var head=this.head;at=this.scan(at,head.next);end=this.scan(end,head);while(at!==end&&at!==head){sliced.push(at.value);at=at.next}return sliced};List.prototype.splice=function(at,length){return this.swap(at,length,Array.prototype.slice.call(arguments,2))};List.prototype.swap=function(start,length,plus,_before,_after){var initial=start;start=this.scan(start,this.head);if(length==null){length=Infinity}plus=Array.from(plus);var minus=[];var at=start;while(length--&&length>=0&&at!==this.head){minus.push(at.value);at=at.next}var index,startNode;index=_before?_before.call(this,start,plus,minus):void 0;var at=start;for(var i=0,at=start;i<minus.length;i++,at=at.next){at["delete"]()}if(initial==null&&at===this.head){at=this.head.next}for(var i=0;i<plus.length;i++){var node=new this.Node(plus[i]);at.addBefore(node)}this.length+=plus.length-minus.length;_after?_after.call(this,start,plus,minus):void 0;return minus};List.prototype.reverse=function(){var at=this.head;do{var temp=at.next;at.next=at.prev;at.prev=temp;at=at.next}while(at!==this.head);return this};List.prototype.sort=function(){this.swap(0,this.length,this.sorted())};List.prototype.reduce=function(callback,basis){var thisp=arguments[2];var head=this.head;var at=head.next;while(at!==head){basis=callback.call(thisp,basis,at.value,at,this);at=at.next}return basis};List.prototype.reduceRight=function(callback,basis){var thisp=arguments[2];var head=this.head;var at=head.prev;while(at!==head){basis=callback.call(thisp,basis,at.value,at,this);at=at.prev}return basis};List.prototype.updateIndexes=function(node,index){while(node!==this.head){node.index=index++;node=node.next}};List.prototype.iterate=function(){return new ListIterator(this.head)};function ListIterator(head){this.head=head;this.at=head.next}ListIterator.prototype.__iterationObject=null;Object.defineProperty(ListIterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:false,value:null})}});ListIterator.prototype.next=function(){if(this.at===this.head){this._iterationObject.done=true;this._iterationObject.value=void 0}else{var value=this.at.value;this.at=this.at.next;this._iterationObject.value=value}return this._iterationObject};List.prototype.Node=Node;function Node(value){this.value=value;this.prev=null;this.next=null}Node.prototype["delete"]=function(){this.prev.next=this.next;this.next.prev=this.prev};Node.prototype.addBefore=function(node){var prev=this.prev;this.prev=node;node.prev=prev;prev.next=node;node.next=this};Node.prototype.addAfter=function(node){var next=this.next;this.next=node;node.next=next;next.prev=node;node.prev=this}},{"./generic-collection":20,"./generic-order":22,"./shim":32}],18:[function(require,module,exports){(function(global){"use strict";var Shim=require("./shim");var GenericCollection=require("./generic-collection");var Map,GlobalMap,CollectionsMap;if(global.Map!==void 0&&typeof global.Set.prototype.values==="function"){Map=module.exports=global.Map,GlobalMap=Map;Map.Map=Map;var protoIsSupported={}.__proto__===Object.prototype,map_makeObservable;if(protoIsSupported){map_makeObservable=function(){this.__proto__=ChangeDispatchMap}}else{map_makeObservable=function(){Object.defineProperties(this,observableSetProperties)}}Object.defineProperty(Map.prototype,"makeObservable",{value:map_makeObservable,writable:true,configurable:true,enumerable:false});Object.defineProperty(Map.prototype,"makePropertyObservable",{value:function(){},writable:true,configurable:true,enumerable:false});Map.prototype.constructClone=function(values){return new this.constructor(values)};Map.prototype.isMap=true;Map.prototype.addEach=function(values){if(values&&Object(values)===values){if(typeof values.forEach==="function"){if(values.isMap===true){values.forEach(function(value,key){this.set(key,value)},this)}else{values.forEach(function(pair){this.set(pair[0],pair[1])},this)}}else if(typeof values.length==="number"){for(var i=0;i<values.length;i++){this.add(values[i],i)}}else{Object.keys(values).forEach(function(key){this.set(key,values[key])},this)}}else if(values&&typeof values.length==="number"){for(var i=0;i<values.length;i++){this.add(values[i],i)}}return this};Map.prototype.add=function(value,key){return this.set(key,value)};Map.prototype.reduce=function(callback,basis){var thisp=arguments[2];this.forEach(function(value,key,map){basis=callback.call(thisp,basis,value,key,this)});return basis};Map.prototype.reduceRight=function(callback,basis){var thisp=arguments[2];var keysIterator=this.keys();var size=this.size;var reverseOrder=new Array(this.size);var aKey,i=0;while(aKey=keysIterator.next().value){reverseOrder[--size]=aKey}while(i++<size){basis=callback.call(thisp,basis,this.get(reverseOrder[i]),reverseOrder[i],this)}return basis};Map.prototype.equals=function(that,equals){equals=equals||Object.equals;if(this===that){return true}else if(that&&typeof that.every==="function"){return that.size===this.size&&that.every(function(value,key){return equals(this.get(key),value)},this)}else{var keys=Object.keys(that);return keys.length===this.size&&Object.keys(that).every(function(key){return equals(this.get(key),that[key])},this)}};var _keysArrayFunction=function(value,key){return key};Map.prototype.keysArray=function(){return this.map(_keysArrayFunction)};var _valuesArrayFunction=function(value,key){return value};Map.prototype.valuesArray=function(){return this.map(_valuesArrayFunction)};var _entriesArrayFunction=function(value,key){return[key,value]};Map.prototype.entriesArray=function(){return this.map(_entriesArrayFunction)};Map.prototype.toJSON=function(){return this.entriesArray()};Map.prototype.items=function(){return this.entriesArray()};Map.from=function(value){var result=new this;result.addEach(value);return result};Object.defineProperty(Map.prototype,"length",{get:function(){return this.size},enumerable:true,configurable:true});var map_clear=Map.prototype.clear,map_set=Map.prototype.set,map_delete=Map.prototype.delete;var observableMapProperties={clear:{value:function(){var keys;if(this.dispatchesMapChanges){this.forEach(function(value,key){this.dispatchBeforeMapChange(key,value)},this);keys=this.keysArray()}map_clear.call(this);if(this.dispatchesMapChanges){keys.forEach(function(key){this.dispatchMapChange(key)},this)}},writable:true,configurable:true},set:{value:function(key,value){var found=this.get(key);if(found){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,found)}map_set.call(this,key,value);if(this.dispatchesMapChanges){this.dispatchMapChange(key,value)}}else{if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,undefined)}map_set.call(this,key,value);if(this.dispatchesMapChanges){this.dispatchMapChange(key,value)}}return this},writable:true,configurable:true},delete:{value:function(key){if(this.has(key)){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,this.get(key))}map_delete.call(this,key);if(this.dispatchesMapChanges){this.dispatchMapChange(key,undefined)}return true}return false;
}}};Object.addEach(Map.prototype,GenericCollection.prototype,false);var ChangeDispatchMap=Object.create(Map.prototype,observableMapProperties)}var Set=require("./_set").CollectionsSet;var GenericMap=require("./generic-map");CollectionsMap=Map=function Map(values,equals,hash,getDefault){if(!(this instanceof Map)){return new Map(values,equals,hash,getDefault)}equals=equals||Object.equals;hash=hash||Object.hash;getDefault=getDefault||Function.noop;this.contentEquals=equals;this.contentHash=hash;this.getDefault=getDefault;this.store=new Set(undefined,function keysEqual(a,b){return equals(a.key,b.key)},function keyHash(item){return hash(item.key)});this.length=0;this.addEach(values)};Map.Map=Map;Object.addEach(Map.prototype,GenericCollection.prototype);Object.addEach(Map.prototype,GenericMap.prototype);Object.defineProperty(Map.prototype,"size",GenericCollection._sizePropertyDescriptor);Map.from=GenericCollection.from;Map.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)};Map.prototype.log=function(charmap,logNode,callback,thisp){logNode=logNode||this.logNode;this.store.log(charmap,function(node,log,logBefore){logNode(node.value.value,log,logBefore)},callback,thisp)};Map.prototype.logNode=function(node,log){log(" key: "+node.key);log(" value: "+node.value)};if(!GlobalMap){module.exports=CollectionsMap}else{module.exports=GlobalMap;GlobalMap.CollectionsMap=CollectionsMap}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./_set":19,"./generic-collection":20,"./generic-map":21,"./shim":32}],19:[function(require,module,exports){(function(global){"use strict";var Shim=require("./shim");var GenericCollection=require("./generic-collection");var GenericSet=require("./generic-set");var Set,GlobalSet,CollectionsSet;if(global.Set!==void 0&&typeof global.Set.prototype.values==="function"){GlobalSet=module.exports=global.Set;GlobalSet.Set=GlobalSet;GlobalSet.prototype.reduce=function(callback,basis){var thisp=arguments[2];this.forEach(function(value){basis=callback.call(thisp,basis,value,this)});return basis};GlobalSet.prototype.reduceRight=function(callback,basis){var thisp=arguments[2];var setIterator=this.values();var size=this.size;var reverseOrder=new Array(this.size);var value,i=0;while(value=setIterator.next().value){reverseOrder[--size]=value}while(i++<size){basis=callback.call(thisp,basis,value,this)}return basis};GlobalSet.prototype.equals=function(that,equals){var self=this;return that&&typeof that.reduce==="function"&&this.size===(that.size||that.length)&&that.reduce(function(equal,value){return equal&&self.has(value,equals)},true)};GlobalSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)};GlobalSet.prototype.toJSON=function(){return this.entriesArray()};GlobalSet.prototype.one=function(){if(this.size>0){return this.values().next().value}return undefined};GlobalSet.prototype.pop=function(){if(this.size){var setIterator=this.values(),aValue,value;while(aValue=setIterator.next().value){value=aValue}this["delete"](value,this.size-1);return value}};GlobalSet.prototype.shift=function(){if(this.size){var firstValue=this.values().next().value;this["delete"](firstValue,0);return firstValue}};Object.defineProperty(GlobalSet.prototype,"length",{get:function(){return this.size},enumerable:true,configurable:true});GlobalSet.from=function(value){var result=new this;result.addEach(value);return result};Object.addEach(GlobalSet.prototype,GenericCollection.prototype,false);Object.addEach(GlobalSet.prototype,GenericSet.prototype,false)}var List=require("./_list");var FastSet=require("./_fast-set");var Iterator=require("./iterator");CollectionsSet=function CollectionsSet(values,equals,hash,getDefault){return CollectionsSet._init(CollectionsSet,this,values,equals,hash,getDefault)};CollectionsSet._init=function(constructor,object,values,equals,hash,getDefault){if(!(object instanceof constructor)){return new constructor(values,equals,hash,getDefault)}equals=equals||Object.equals;hash=hash||Object.hash;getDefault=getDefault||Function.noop;object.contentEquals=equals;object.contentHash=hash;object.getDefault=getDefault;object.order=new object.Order(undefined,equals);object.store=new object.Store(undefined,function(a,b){return equals(a.value,b.value)},function(node){return hash(node.value)});object.length=0;object.addEach(values)};CollectionsSet.Set=CollectionsSet;CollectionsSet.CollectionsSet=CollectionsSet;Object.addEach(CollectionsSet.prototype,GenericCollection.prototype);Object.addEach(CollectionsSet.prototype,GenericSet.prototype);CollectionsSet.from=GenericCollection.from;Object.defineProperty(CollectionsSet.prototype,"size",GenericCollection._sizePropertyDescriptor);CollectionsSet.prototype.Order=List;CollectionsSet.prototype.Store=FastSet;CollectionsSet.prototype.constructClone=function(values){return new this.constructor(values,this.contentEquals,this.contentHash,this.getDefault)};CollectionsSet.prototype.has=function(value){var node=new this.order.Node(value);return this.store.has(node)};CollectionsSet.prototype.get=function(value,equals){if(equals){throw new Error("Set#get does not support second argument: equals")}var node=new this.order.Node(value);node=this.store.get(node);if(node){return node.value}else{return this.getDefault(value)}};CollectionsSet.prototype.add=function(value){var node=new this.order.Node(value);if(!this.store.has(node)){var index=this.length;this.order.add(value);node=this.order.head.prev;this.store.add(node);this.length++;return true}return false};CollectionsSet.prototype["delete"]=function(value,equals){if(equals){throw new Error("Set#delete does not support second argument: equals")}var node=new this.order.Node(value);if(this.store.has(node)){node=this.store.get(node);this.store["delete"](node);this.order.splice(node,1);this.length--;return true}return false};CollectionsSet.prototype.pop=function(){if(this.length){var result=this.order.head.prev.value;this["delete"](result);return result}};CollectionsSet.prototype.shift=function(){if(this.length){var result=this.order.head.next.value;this["delete"](result);return result}};CollectionsSet.prototype.one=function(){if(this.length>0){return this.store.one().value}};CollectionsSet.prototype.clear=function(){this.store.clear();this.order.clear();this.length=0};Object.defineProperty(CollectionsSet.prototype,"_clear",{value:CollectionsSet.prototype.clear});CollectionsSet.prototype.reduce=function(callback,basis){var thisp=arguments[2];var list=this.order;var index=0;return list.reduce(function(basis,value){return callback.call(thisp,basis,value,index++,this)},basis,this)};CollectionsSet.prototype.reduceRight=function(callback,basis){var thisp=arguments[2];var list=this.order;var index=this.length-1;return list.reduceRight(function(basis,value){return callback.call(thisp,basis,value,index--,this)},basis,this)};CollectionsSet.prototype.iterate=function(){return this.order.iterate()};CollectionsSet.prototype.values=function(){return new Iterator(this)};CollectionsSet.prototype.log=function(){var set=this.store;return set.log.apply(set,arguments)};if(!GlobalSet){module.exports=CollectionsSet}else{GlobalSet.prototype.valuesArray=GenericSet.prototype.valuesArray;GlobalSet.prototype.entriesArray=GenericSet.prototype.entriesArray;module.exports=GlobalSet;GlobalSet.CollectionsSet=CollectionsSet}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./_fast-set":16,"./_list":17,"./generic-collection":20,"./generic-set":23,"./iterator":24,"./shim":32}],20:[function(require,module,exports){(function(global){"use strict";module.exports=GenericCollection;function GenericCollection(){throw new Error("Can't construct. GenericCollection is a mixin.")}var DOMTokenList=global.DOMTokenList||function(){};GenericCollection.EmptyArray=Object.freeze([]);GenericCollection.prototype.addEach=function(values){if(values&&(values instanceof Array||values instanceof DOMTokenList||values instanceof String)){for(var i=0;i<values.length;i++){this.add(values[i],i)}}else if(values&&Object(values)===values){if(typeof values.forEach==="function"){values.forEach(this.add,this)}else if(typeof values.length==="number"){for(var i=0;i<values.length;i++){this.add(values[i],i)}}else{Object.keys(values).forEach(function(key){this.add(values[key],key)},this)}}return this};GenericCollection.prototype.deleteEach=function(values,equals){values.forEach(function(value){this["delete"](value,equals)},this);return this};GenericCollection.prototype.forEach=function(callback){var thisp=arguments[1];return this.reduce(function(undefined,value,key,object,depth){callback.call(thisp,value,key,object,depth)},undefined)};GenericCollection.prototype.map=function(callback){var thisp=arguments[1];var result=[];this.reduce(function(undefined,value,key,object,depth){result.push(callback.call(thisp,value,key,object,depth))},undefined);return result};GenericCollection.prototype.enumerate=function(start){if(start==null){start=0}var result=[];this.reduce(function(undefined,value){result.push([start++,value])},undefined);return result};GenericCollection.prototype.group=function(callback,thisp,equals){equals=equals||Object.equals;var groups=[];var keys=[];this.forEach(function(value,key,object){var key=callback.call(thisp,value,key,object);var index=keys.indexOf(key,equals);var group;if(index===-1){group=[];groups.push([key,group]);keys.push(key)}else{group=groups[index][1]}group.push(value)});return groups};GenericCollection.prototype.toArray=function(){return this.map(Function.identity)};GenericCollection.prototype.toObject=function(){var object={};this.reduce(function(undefined,value,key){object[key]=value},undefined);return object};GenericCollection.from=function(){return this.apply(this,arguments)};GenericCollection.prototype.filter=function(callback){var thisp=arguments[1];var result=this.constructClone();this.reduce(function(undefined,value,key,object,depth){if(callback.call(thisp,value,key,object,depth)){result.add(value,key)}},undefined);return result};GenericCollection.prototype.every=function(callback){var thisp=arguments[1];return this.reduce(function(result,value,key,object,depth){return result&&callback.call(thisp,value,key,object,depth)},true)};GenericCollection.prototype.some=function(callback){var thisp=arguments[1];return this.reduce(function(result,value,key,object,depth){return result||callback.call(thisp,value,key,object,depth)},false)};GenericCollection.prototype.all=function(){return this.every(Boolean)};GenericCollection.prototype.any=function(){return this.some(Boolean)};GenericCollection.prototype.min=function(compare){compare=compare||this.contentCompare||Object.compare;var first=true;return this.reduce(function(result,value){if(first){first=false;return value}else{return compare(value,result)<0?value:result}},undefined)};GenericCollection.prototype.max=function(compare){compare=compare||this.contentCompare||Object.compare;var first=true;return this.reduce(function(result,value){if(first){first=false;return value}else{return compare(value,result)>0?value:result}},undefined)};GenericCollection.prototype.sum=function(zero){zero=zero===undefined?0:zero;return this.reduce(function(a,b){return a+b},zero)};GenericCollection.prototype.average=function(zero){var sum=zero===undefined?0:zero;var count=zero===undefined?0:zero;this.reduce(function(undefined,value){sum+=value;count+=1},undefined);return sum/count};GenericCollection.prototype.concat=function(){var result=this.constructClone(this);for(var i=0;i<arguments.length;i++){result.addEach(arguments[i])}return result};GenericCollection.prototype.flatten=function(){var self=this;return this.reduce(function(result,array){array.forEach(function(value){this.push(value)},result,self);return result},[])};GenericCollection.prototype.zip=function(){var table=Array.prototype.slice.call(arguments);table.unshift(this);return Array.unzip(table)};GenericCollection.prototype.join=function(delimiter){return this.reduce(function(result,string){if(result===void 0){return string}else{return result+delimiter+string}},void 0)};GenericCollection.prototype.sorted=function(compare,by,order){compare=compare||this.contentCompare||Object.compare;if(compare.by){by=compare.by;compare=compare.compare||this.contentCompare||Object.compare}else{by=by||Function.identity}if(order===undefined)order=1;return this.map(function(item){return{by:by(item),value:item}}).sort(function(a,b){return compare(a.by,b.by)*order}).map(function(pair){return pair.value})};GenericCollection.prototype.reversed=function(){return this.constructClone(this).reverse()};GenericCollection.prototype.clone=function(depth,memo){if(depth===undefined){depth=Infinity}else if(depth===0){return this}var clone=this.constructClone();this.forEach(function(value,key){clone.add(Object.clone(value,depth-1,memo),key)},this);return clone};GenericCollection.prototype.only=function(){if(this.length===1){return this.one()}};GenericCollection.prototype.iterator=function(){return this.iterate.apply(this,arguments)};GenericCollection._sizePropertyDescriptor={get:function(){return this.length},enumerable:false,configurable:true};Object.defineProperty(GenericCollection.prototype,"size",GenericCollection._sizePropertyDescriptor);require("./shim-array")}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./shim-array":28}],21:[function(require,module,exports){"use strict";var Object=require("./shim-object");var Iterator=require("./iterator");module.exports=GenericMap;function GenericMap(){throw new Error("Can't construct. GenericMap is a mixin.")}GenericMap.prototype.isMap=true;GenericMap.prototype.addEach=function(values){var i;if(values&&Object(values)===values){if(typeof values.forEach==="function"){if(values.isMap===true){values.forEach(function(value,key){this.set(key,value)},this)}else{values.forEach(function(pair){this.set(pair[0],pair[1])},this)}}else if(typeof values.length==="number"){for(i=0;i<values.length;i++){this.add(values[i],i)}}else{Object.keys(values).forEach(function(key){this.set(key,values[key])},this)}}else if(values&&typeof values.length==="number"){for(i=0;i<values.length;i++){this.add(values[i],i)}}return this};GenericMap.prototype.get=function(key,defaultValue){var item=this.store.get(new this.Item(key));if(item){return item.value}else if(arguments.length>1){console.log("Use of a second argument as default value is deprecated to match standards");return defaultValue}else{return this.getDefault(key)}};GenericMap.prototype.set=function(key,value){var item=new this.Item(key,value);var found=this.store.get(item);var grew=false;if(found){if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,found.value)}found.value=value;if(this.dispatchesMapChanges){this.dispatchMapChange(key,value)}}else{if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,undefined)}if(this.store.add(item)){this.length++;grew=true}if(this.dispatchesMapChanges){this.dispatchMapChange(key,value)}}return grew};GenericMap.prototype.add=function(value,key){return this.set(key,value)};GenericMap.prototype.has=function(key){return this.store.has(new this.Item(key))};GenericMap.prototype["delete"]=function(key){var item=new this.Item(key);if(this.store.has(item)){var from=this.store.get(item).value;if(this.dispatchesMapChanges){this.dispatchBeforeMapChange(key,from)}this.store["delete"](item);this.length--;if(this.dispatchesMapChanges){this.dispatchMapChange(key,undefined)}return true}return false};GenericMap.prototype.clear=function(){var keys,key;if(this.dispatchesMapChanges){this.forEach(function(value,key){this.dispatchBeforeMapChange(key,value)},this);keys=this.keysArray()}this.store.clear();this.length=0;if(this.dispatchesMapChanges){for(var i=0;key=keys[i];i++){this.dispatchMapChange(key)}}};GenericMap.prototype.reduce=function(callback,basis,thisp){return this.store.reduce(function(basis,item){return callback.call(thisp,basis,item.value,item.key,this)},basis,this)};GenericMap.prototype.reduceRight=function(callback,basis,thisp){return this.store.reduceRight(function(basis,item){return callback.call(thisp,basis,item.value,item.key,this)},basis,this)};GenericMap.prototype.keysArray=function(){return this.map(function(value,key){return key})};GenericMap.prototype.keys=function(){return new Iterator(this.keysArray())};GenericMap.prototype.valuesArray=function(){return this.map(Function.identity)};GenericMap.prototype.values=function(){return new Iterator(this.valuesArray())};GenericMap.prototype.entriesArray=function(){return this.map(function(value,key){return[key,value]})};GenericMap.prototype.entries=function(){return new Iterator(this.entriesArray())};GenericMap.prototype.items=function(){return this.entriesArray()};GenericMap.prototype.equals=function(that,equals){equals=equals||Object.equals;if(this===that){return true}else if(that&&typeof that.every==="function"){return that.length===this.length&&that.every(function(value,key){return equals(this.get(key),value)},this)}else{var keys=Object.keys(that);return keys.length===this.length&&Object.keys(that).every(function(key){return equals(this.get(key),that[key])},this)}};GenericMap.prototype.toJSON=function(){return this.entriesArray()};GenericMap.prototype.Item=Item;function Item(key,value){this.key=key;this.value=value}Item.prototype.equals=function(that){return Object.equals(this.key,that.key)&&Object.equals(this.value,that.value)};Item.prototype.compare=function(that){return Object.compare(this.key,that.key)}},{"./iterator":24,"./shim-object":30}],22:[function(require,module,exports){var Object=require("./shim-object");module.exports=GenericOrder;function GenericOrder(){throw new Error("Can't construct. GenericOrder is a mixin.")}GenericOrder.prototype.equals=function(that,equals){equals=equals||this.contentEquals||Object.equals;if(this===that){return true}if(!that){return false}var self=this;return this.length===that.length&&this.zip(that).every(function(pair){return equals(pair[0],pair[1])})};GenericOrder.prototype.compare=function(that,compare){compare=compare||this.contentCompare||Object.compare;if(this===that){return 0}if(!that){return 1}var length=Math.min(this.length,that.length);var comparison=this.zip(that).reduce(function(comparison,pair,index){if(comparison===0){if(index>=length){return comparison}else{return compare(pair[0],pair[1])}}else{return comparison}},0);if(comparison===0){return this.length-that.length}return comparison};GenericOrder.prototype.toJSON=function(){return this.toArray()}},{"./shim-object":30}],23:[function(require,module,exports){module.exports=GenericSet;function GenericSet(){throw new Error("Can't construct. GenericSet is a mixin.")}GenericSet.prototype.isSet=true;GenericSet.prototype.union=function(that){var union=this.constructClone(this);union.addEach(that);return union};GenericSet.prototype.intersection=function(that){return this.constructClone(this.filter(function(value){return that.has(value)}))};GenericSet.prototype.difference=function(that){var union=this.constructClone(this);union.deleteEach(that);return union};GenericSet.prototype.symmetricDifference=function(that){var union=this.union(that);var intersection=this.intersection(that);return union.difference(intersection)};GenericSet.prototype.deleteAll=function(value){return+this["delete"](value)};GenericSet.prototype.equals=function(that,equals){var self=this;return that&&typeof that.reduce==="function"&&this.length===that.length&&that.reduce(function(equal,value){return equal&&self.has(value,equals)},true)};GenericSet.prototype.forEach=function(callback){var thisp=arguments[1];return this.reduce(function(undefined,value,key,object,depth){callback.call(thisp,value,value,object,depth)},undefined)};GenericSet.prototype.toJSON=function(){return this.toArray()};GenericSet.prototype.contains=function(value){return this.has(value)};GenericSet.prototype.remove=function(value){return this["delete"](value)};GenericSet.prototype.toggle=function(value){if(this.has(value)){this["delete"](value)}else{this.add(value)}};var _valuesArrayFunction=function(value,key){return value};GenericSet.prototype.valuesArray=function(){return this.map(_valuesArrayFunction)};var _entriesArrayFunction=function(value,key){return[key,value]};GenericSet.prototype.entriesArray=function(){return this.map(_entriesArrayFunction)}},{}],24:[function(require,module,exports){"use strict";module.exports=Iterator;var Object=require("./shim-object");var GenericCollection=require("./generic-collection");function Iterator(iterable){var values=iterable&&iterable.values&&iterable.values();if(values&&typeof values.next==="function"){return values}if(!(this instanceof Iterator)){return new Iterator(iterable)}if(Array.isArray(iterable)||typeof iterable==="string")return Iterator.iterate(iterable);iterable=Object(iterable);if(iterable instanceof Iterator){return iterable}else if(iterable.next){this.next=function(){return iterable.next()}}else if(iterable.iterate){var iterator=iterable.iterate();this.next=function(){return iterator.next()}}else if(Object.prototype.toString.call(iterable)==="[object Function]"){this.next=iterable}else{throw new TypeError("Can't iterate "+iterable)}}Iterator.prototype.forEach=GenericCollection.prototype.forEach;Iterator.prototype.map=GenericCollection.prototype.map;Iterator.prototype.filter=GenericCollection.prototype.filter;Iterator.prototype.every=GenericCollection.prototype.every;Iterator.prototype.some=GenericCollection.prototype.some;Iterator.prototype.any=GenericCollection.prototype.any;Iterator.prototype.all=GenericCollection.prototype.all;Iterator.prototype.min=GenericCollection.prototype.min;Iterator.prototype.max=GenericCollection.prototype.max;Iterator.prototype.sum=GenericCollection.prototype.sum;Iterator.prototype.average=GenericCollection.prototype.average;Iterator.prototype.flatten=GenericCollection.prototype.flatten;Iterator.prototype.zip=GenericCollection.prototype.zip;Iterator.prototype.enumerate=GenericCollection.prototype.enumerate;Iterator.prototype.sorted=GenericCollection.prototype.sorted;Iterator.prototype.group=GenericCollection.prototype.group;Iterator.prototype.reversed=GenericCollection.prototype.reversed;Iterator.prototype.toArray=GenericCollection.prototype.toArray;Iterator.prototype.toObject=GenericCollection.prototype.toObject;Iterator.prototype.iterator=GenericCollection.prototype.iterator;Iterator.prototype.__iterationObject=null;Object.defineProperty(Iterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:false,value:void 0})}});Iterator.prototype.constructClone=function(values){var clone=[];clone.addEach(values);return clone};Iterator.prototype.mapIterator=function(callback){var self=Iterator(this),thisp=arguments[1],i=0;if(Object.prototype.toString.call(callback)!="[object Function]")throw new TypeError;return new self.constructor(function(){if(self._iterationObject.done!==true){var callbackValue=callback.call(thisp,self.next().value,i++,self);self._iterationObject.value=callbackValue}return self._iterationObject})};Iterator.prototype.filterIterator=function(callback){var self=Iterator(this),thisp=arguments[1],i=0;if(Object.prototype.toString.call(callback)!="[object Function]")throw new TypeError;return new self.constructor(function(){var nextEntry;while(true){nextEntry=self.next();if(nextEntry.done!==true){if(callback.call(thisp,nextEntry.value,i++,self))return nextEntry}else{return nextEntry}}})};Iterator.prototype.reduce=function(callback){var self=Iterator(this),result=arguments[1],thisp=arguments[2],i=0,nextEntry;if(Object.prototype.toString.call(callback)!="[object Function]")throw new TypeError;nextEntry=self.next();if(nextEntry.done===true){if(arguments.length>1){return arguments[1]}else{throw TypeError("cannot reduce a value from an empty iterator with no initial value")}}if(arguments.length>1){result=callback.call(thisp,result,nextEntry.value,i,self)}else{result=nextEntry.value}i++;while(true){nextEntry=self.next();if(nextEntry.done===true){return result}result=callback.call(thisp,result,nextEntry.value,i,self);i++}};Iterator.prototype.concat=function(){return Iterator.concat(Array.prototype.concat.apply(this,arguments))};Iterator.prototype.dropWhile=function(callback){var self=Iterator(this),thisp=arguments[1],stopped=false,stopValue,nextEntry,i=0;if(Object.prototype.toString.call(callback)!="[object Function]")throw new TypeError;while(true){nextEntry=self.next();if(nextEntry.done===true){break}if(!callback.call(thisp,nextEntry.value,i,self)){stopped=true;stopValue=nextEntry.value;break}i++}if(stopped){return self.constructor([stopValue]).concat(self)}else{return self.constructor([])}};Iterator.prototype.takeWhile=function(callback){var self=Iterator(this),thisp=arguments[1],nextEntry,i=0;if(Object.prototype.toString.call(callback)!="[object Function]")throw new TypeError;return new self.constructor(function(){if(self._iterationObject.done!==true){var value=self.next().value;if(callback.call(thisp,value,i++,self)){self._iterationObject.value=value}else{self._iterationObject.done=true;self._iterationObject.value=void 0}}return self._iterationObject})};Iterator.prototype.zipIterator=function(){return Iterator.unzip(Array.prototype.concat.apply(this,arguments))};Iterator.prototype.enumerateIterator=function(start){return Iterator.count(start).zipIterator(this)};Iterator.iterate=function(iterable){var start;start=0;return new Iterator(function(){if(typeof iterable==="object"){while(!(start in iterable)){if(start>=iterable.length){this._iterationObject.done=true;this._iterationObject.value=void 0;break}else start+=1}}else if(start>=iterable.length){this._iterationObject.done=true;this._iterationObject.value=void 0}if(!this._iterationObject.done){this._iterationObject.value=iterable[start];start+=1}return this._iterationObject})};Iterator.cycle=function(cycle,times){var next;if(arguments.length<2)times=Infinity;return new Iterator(function(){var iteration,nextEntry;if(next){nextEntry=next()}if(!next||nextEntry.done===true){if(times>0){times--;iteration=Iterator.iterate(cycle);nextEntry=(next=iteration.next.bind(iteration))()}else{this._iterationObject.done=true;nextEntry=this._iterationObject}}return nextEntry})};Iterator.concat=function(iterators){iterators=Iterator(iterators);var next;return new Iterator(function(){var iteration,nextEntry;if(next)nextEntry=next();if(!nextEntry||nextEntry.done===true){nextEntry=iterators.next();if(nextEntry.done===false){iteration=Iterator(nextEntry.value);next=iteration.next.bind(iteration);return next()}else{return nextEntry}}else return nextEntry})};Iterator.unzip=function(iterators){iterators=Iterator(iterators).map(Iterator);if(iterators.length===0)return new Iterator([]);return new Iterator(function(){var stopped,nextEntry;var result=iterators.map(function(iterator){nextEntry=iterator.next();if(nextEntry.done===true){stopped=true}return nextEntry.value});if(stopped){this._iterationObject.done=true;this._iterationObject.value=void 0}else{this._iterationObject.value=result}return this._iterationObject})};Iterator.zip=function(){return Iterator.unzip(Array.prototype.slice.call(arguments))};Iterator.chain=function(){return Iterator.concat(Array.prototype.slice.call(arguments))};Iterator.range=function(start,stop,step){if(arguments.length<3){step=1}if(arguments.length<2){stop=start;start=0}start=start||0;step=step||1;return new Iterator(function(){if(start>=stop){this._iterationObject.done=true;this._iterationObject.value=void 0}var result=start;start+=step;this._iterationObject.value=result;return this._iterationObject})};Iterator.count=function(start,step){return Iterator.range(start,Infinity,step)};Iterator.repeat=function(value,times){return new Iterator.range(times).mapIterator(function(){return value})}},{"./generic-collection":20,"./shim-object":30}],25:[function(require,module,exports){var Map=require("../_map");var ObjectChangeDescriptor=module.exports.ObjectChangeDescriptor=function ObjectChangeDescriptor(name){this.name=name;this.isActive=false;this._willChangeListeners=null;this._changeListeners=null;return this};Object.defineProperties(ObjectChangeDescriptor.prototype,{name:{value:null,writable:true},isActive:{value:false,writable:true},_willChangeListeners:{value:null,writable:true},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new this.willChangeListenersRecordConstructor(this.name))}},_changeListeners:{value:null,writable:true},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new this.changeListenersRecordConstructor(this.name))}},changeListenersRecordConstructor:{value:ChangeListenersRecord,writable:true},willChangeListenersRecordConstructor:{value:ChangeListenersRecord,writable:true}});var ListenerGhost=module.exports.ListenerGhost=Object.create(null);var ChangeListenerSpecificHandlerMethodName=new Map;module.exports.ChangeListenersRecord=ChangeListenersRecord;function ChangeListenersRecord(name){var specificHandlerMethodName=ChangeListenerSpecificHandlerMethodName.get(name);if(!specificHandlerMethodName){specificHandlerMethodName="handle";specificHandlerMethodName+=name;specificHandlerMethodName+="Change";ChangeListenerSpecificHandlerMethodName.set(name,specificHandlerMethodName)}this._current=null;this._current=null;this.specificHandlerMethodName=specificHandlerMethodName;return this}Object.defineProperties(ChangeListenersRecord.prototype,{_current:{value:null,writable:true},current:{get:function(){return this._current},set:function(value){this._current=value}},ListenerGhost:{value:ListenerGhost,writable:true},ghostCount:{value:0,writable:true},maxListenerGhostRatio:{value:.3,writable:true},listenerGhostFilter:{value:function listenerGhostFilter(value){return value!==this.ListenerGhost}},removeCurrentGostListenersIfNeeded:{value:function(){if(this._current&&this.ghostCount/this._current.length>this.maxListenerGhostRatio){this.ghostCount=0;this._current=this._current.filter(this.listenerGhostFilter,this)}return this._current}},dispatchBeforeChange:{value:false,writable:true},genericHandlerMethodName:{value:"handlePropertyChange",writable:true}});module.exports.WillChangeListenersRecord=WillChangeListenersRecord;var WillChangeListenerSpecificHandlerMethodName=new Map;function WillChangeListenersRecord(name){var specificHandlerMethodName=WillChangeListenerSpecificHandlerMethodName.get(name);if(!specificHandlerMethodName){specificHandlerMethodName="handle";specificHandlerMethodName+=name;specificHandlerMethodName+="WillChange";WillChangeListenerSpecificHandlerMethodName.set(name,specificHandlerMethodName)}this.specificHandlerMethodName=specificHandlerMethodName;return this}WillChangeListenersRecord.prototype=new ChangeListenersRecord;WillChangeListenersRecord.prototype.constructor=WillChangeListenersRecord;WillChangeListenersRecord.prototype.genericHandlerMethodName="handlePropertyWillChange"},{"../_map":18}],26:[function(require,module,exports){var objectHasOwnProperty=Object.prototype.hasOwnProperty;module.exports=PropertyChanges;function PropertyChanges(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}require("../shim");var Map=require("../_map");var WeakMap=require("../weak-map");var ChangeDescriptor=require("./change-descriptor"),ObjectChangeDescriptor=ChangeDescriptor.ObjectChangeDescriptor,ListenerGhost=ChangeDescriptor.ListenerGhost;PropertyChanges.debug=true;var ObjectsPropertyChangeListeners=new WeakMap;var ObjectChangeDescriptorName=new Map;PropertyChanges.ObjectChangeDescriptor=function(){};PropertyChanges.prototype.getOwnPropertyChangeDescriptor=function(key){var objectPropertyChangeDescriptors=ObjectsPropertyChangeListeners.get(this),keyChangeDescriptor;
if(!objectPropertyChangeDescriptors){objectPropertyChangeDescriptors=Object.create(null);ObjectsPropertyChangeListeners.set(this,objectPropertyChangeDescriptors)}if((keyChangeDescriptor=objectPropertyChangeDescriptors[key])===void 0){var propertyName=ObjectChangeDescriptorName.get(key);if(!propertyName){propertyName=String(key);propertyName=propertyName&&propertyName[0].toUpperCase()+propertyName.slice(1);ObjectChangeDescriptorName.set(key,propertyName)}return objectPropertyChangeDescriptors[key]=new ObjectChangeDescriptor(propertyName)}return keyChangeDescriptor};PropertyChanges.prototype.hasOwnPropertyChangeDescriptor=function(key){var objectPropertyChangeDescriptors=ObjectsPropertyChangeListeners.get(this);if(!objectPropertyChangeDescriptors){return false}if(!key){return true}if(objectPropertyChangeDescriptors[key]===void 0){return false}return true};PropertyChanges.prototype.addOwnPropertyChangeListener=function(key,listener,beforeChange){if(this.makeObservable&&!this.isObservable){this.makeObservable()}var descriptor=PropertyChanges.getOwnPropertyChangeDescriptor(this,key),listeners=beforeChange?descriptor.willChangeListeners:descriptor.changeListeners;PropertyChanges.makePropertyObservable(this,key);if(!listeners._current){listeners._current=listener}else if(!Array.isArray(listeners._current)){listeners._current=[listeners._current,listener]}else{listeners._current.push(listener)}var self=this;return function cancelOwnPropertyChangeListener(){PropertyChanges.removeOwnPropertyChangeListener(self,key,listener,beforeChange);self=null}};PropertyChanges.prototype.addBeforeOwnPropertyChangeListener=function(key,listener){return PropertyChanges.addOwnPropertyChangeListener(this,key,listener,true)};PropertyChanges.prototype.removeOwnPropertyChangeListener=function removeOwnPropertyChangeListener(key,listener,beforeChange){var descriptor=PropertyChanges.getOwnPropertyChangeDescriptor(this,key);var listeners;if(beforeChange){listeners=descriptor._willChangeListeners}else{listeners=descriptor._changeListeners}if(listeners){if(listeners._current){if(listeners._current===listener){listeners._current=null}else{var index=listeners._current.lastIndexOf(listener);if(index===-1){throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(key))}if(descriptor.isActive){listeners.ghostCount=listeners.ghostCount+1;listeners._current[index]=removeOwnPropertyChangeListener.ListenerGhost}else{listeners._current.spliceOne(index)}}}}};PropertyChanges.prototype.removeOwnPropertyChangeListener.ListenerGhost=ListenerGhost;PropertyChanges.prototype.removeBeforeOwnPropertyChangeListener=function(key,listener){return PropertyChanges.removeOwnPropertyChangeListener(this,key,listener,true)};PropertyChanges.prototype.dispatchOwnPropertyChange=function dispatchOwnPropertyChange(key,value,beforeChange){var descriptor=PropertyChanges.getOwnPropertyChangeDescriptor(this,key),listeners;if(!descriptor.isActive){descriptor.isActive=true;listeners=beforeChange?descriptor._willChangeListeners:descriptor._changeListeners;try{dispatchOwnPropertyChange.dispatchEach(listeners,key,value,this)}finally{descriptor.isActive=false}}};PropertyChanges.prototype.dispatchOwnPropertyChange.dispatchEach=dispatchEach;function dispatchEach(listeners,key,value,object){if(listeners&&listeners._current){var current,listener,i,countI,thisp,specificHandlerMethodName=listeners.specificHandlerMethodName,genericHandlerMethodName=listeners.genericHandlerMethodName,Ghost=ListenerGhost;if(Array.isArray(listeners._current)){current=listeners.removeCurrentGostListenersIfNeeded();for(i=0,countI=current.length;i<countI;i++){if((thisp=current[i])!==Ghost){listener=thisp[specificHandlerMethodName]||thisp[genericHandlerMethodName]||thisp;if(!listener.call){throw new Error("No event listener for "+listeners.specificHandlerName+" or "+listeners.genericHandlerName+" or call on "+listener)}listener.call(thisp,value,key,object)}}}else{thisp=listeners._current;listener=thisp[specificHandlerMethodName]||thisp[genericHandlerMethodName]||thisp;if(!listener.call){throw new Error("No event listener for "+listeners.specificHandlerName+" or "+listeners.genericHandlerName+" or call on "+listener)}listener.call(thisp,value,key,object)}}}dispatchEach.ListenerGhost=ListenerGhost;PropertyChanges.prototype.dispatchBeforeOwnPropertyChange=function(key,listener){return PropertyChanges.dispatchOwnPropertyChange(this,key,listener,true)};var ObjectsOverriddenPropertyDescriptors=new WeakMap,Objects__state__=new WeakMap,propertyListener={get:void 0,set:void 0,configurable:true,enumerable:false};PropertyChanges.prototype.makePropertyObservable=function(key){var overriddenPropertyDescriptors=ObjectsOverriddenPropertyDescriptors.get(this);if(overriddenPropertyDescriptors&&overriddenPropertyDescriptors.get(key)!==void 0){return}if(!overriddenPropertyDescriptors){if(Array.isArray(this)){return}if(!Object.isExtensible(this)){throw new Error("Can't make property "+JSON.stringify(key)+" observable on "+this+" because object is not extensible")}overriddenPropertyDescriptors=new Map;ObjectsOverriddenPropertyDescriptors.set(this,overriddenPropertyDescriptors)}var overriddenDescriptor;var attached=this;do{overriddenDescriptor=Object.getOwnPropertyDescriptor(attached,key);if(overriddenDescriptor){break}attached=Object.getPrototypeOf(attached)}while(attached);if(!overriddenDescriptor){overriddenDescriptor={value:void 0,enumerable:true,writable:true,configurable:true}}else{if(!overriddenDescriptor.configurable){return}if(!overriddenDescriptor.writable&&!overriddenDescriptor.set){return}}overriddenPropertyDescriptors.set(key,overriddenDescriptor);if("value"in overriddenDescriptor){propertyListener.get=function(){return overriddenDescriptor.value};propertyListener.set=function dispatchingSetter(value){var descriptor,isActive,overriddenDescriptor=dispatchingSetter.overriddenDescriptor;if(value!==overriddenDescriptor.value){descriptor=dispatchingSetter.descriptor;if(!(isActive=descriptor.isActive)){descriptor.isActive=true;try{dispatchingSetter.dispatchEach(descriptor._willChangeListeners,key,overriddenDescriptor.value,this)}finally{}}overriddenDescriptor.value=value;if(!isActive){try{dispatchingSetter.dispatchEach(descriptor._changeListeners,key,value,this)}finally{descriptor.isActive=false}}}};propertyListener.set.dispatchEach=dispatchEach;propertyListener.set.overriddenDescriptor=overriddenDescriptor;propertyListener.set.descriptor=ObjectsPropertyChangeListeners.get(this)[key];propertyListener.enumerable=overriddenDescriptor.enumerable;propertyListener.configurable=true}else{propertyListener.get=overriddenDescriptor.get;propertyListener.set=function dispatchingSetter(){var formerValue=dispatchingSetter.overriddenGetter.call(this),descriptor,isActive,newValue;if(arguments.length===1){dispatchingSetter.overriddenSetter.call(this,arguments[0])}else if(arguments.length===2){dispatchingSetter.overriddenSetter.call(this,arguments[0],arguments[1])}else{dispatchingSetter.overriddenSetter.apply(this,arguments)}if((newValue=dispatchingSetter.overriddenGetter.call(this))!==formerValue){descriptor=dispatchingSetter.descriptor;if(!(isActive=descriptor.isActive)){descriptor.isActive=true;try{dispatchingSetter.dispatchEach(descriptor._willChangeListeners,key,formerValue,this)}finally{}}if(!isActive){try{dispatchingSetter.dispatchEach(descriptor._changeListeners,key,newValue,this)}finally{descriptor.isActive=false}}}};propertyListener.enumerable=overriddenDescriptor.enumerable;propertyListener.configurable=true;propertyListener.set.dispatchEach=dispatchEach;propertyListener.set.overriddenSetter=overriddenDescriptor.set;propertyListener.set.overriddenGetter=overriddenDescriptor.get;propertyListener.set.descriptor=ObjectsPropertyChangeListeners.get(this)[key]}Object.defineProperty(this,key,propertyListener)};PropertyChanges.getOwnPropertyChangeDescriptor=function(object,key){if(object.getOwnPropertyChangeDescriptor){return object.getOwnPropertyChangeDescriptor(key)}else{return PropertyChanges.prototype.getOwnPropertyChangeDescriptor.call(object,key)}};PropertyChanges.hasOwnPropertyChangeDescriptor=function(object,key){if(object.hasOwnPropertyChangeDescriptor){return object.hasOwnPropertyChangeDescriptor(key)}else{return PropertyChanges.prototype.hasOwnPropertyChangeDescriptor.call(object,key)}};PropertyChanges.addOwnPropertyChangeListener=function(object,key,listener,beforeChange){if(Object.isObject(object)){return object.addOwnPropertyChangeListener?object.addOwnPropertyChangeListener(key,listener,beforeChange):this.prototype.addOwnPropertyChangeListener.call(object,key,listener,beforeChange)}};PropertyChanges.removeOwnPropertyChangeListener=function(object,key,listener,beforeChange){if(!Object.isObject(object)){}else if(object.removeOwnPropertyChangeListener){return object.removeOwnPropertyChangeListener(key,listener,beforeChange)}else{return PropertyChanges.prototype.removeOwnPropertyChangeListener.call(object,key,listener,beforeChange)}};PropertyChanges.dispatchOwnPropertyChange=function(object,key,value,beforeChange){if(!Object.isObject(object)){}else if(object.dispatchOwnPropertyChange){return object.dispatchOwnPropertyChange(key,value,beforeChange)}else{return PropertyChanges.prototype.dispatchOwnPropertyChange.call(object,key,value,beforeChange)}};PropertyChanges.addBeforeOwnPropertyChangeListener=function(object,key,listener){return PropertyChanges.addOwnPropertyChangeListener(object,key,listener,true)};PropertyChanges.removeBeforeOwnPropertyChangeListener=function(object,key,listener){return PropertyChanges.removeOwnPropertyChangeListener(object,key,listener,true)};PropertyChanges.dispatchBeforeOwnPropertyChange=function(object,key,value){return PropertyChanges.dispatchOwnPropertyChange(object,key,value,true)};PropertyChanges.makePropertyObservable=function(object,key){if(object.makePropertyObservable){return object.makePropertyObservable(key)}else{return PropertyChanges.prototype.makePropertyObservable.call(object,key)}}},{"../_map":18,"../shim":32,"../weak-map":35,"./change-descriptor":25}],27:[function(require,module,exports){"use strict";var WeakMap=require("weak-map"),Map=require("../_map"),ChangeDescriptor=require("./change-descriptor"),ObjectChangeDescriptor=ChangeDescriptor.ObjectChangeDescriptor,ChangeListenersRecord=ChangeDescriptor.ChangeListenersRecord,ListenerGhost=ChangeDescriptor.ListenerGhost;var rangeChangeDescriptors=new WeakMap;function RangeChangeDescriptor(name){this.name=name;this.isActive=false;this._willChangeListeners=null;this._changeListeners=null}RangeChangeDescriptor.prototype=new ObjectChangeDescriptor;RangeChangeDescriptor.prototype.constructor=RangeChangeDescriptor;RangeChangeDescriptor.prototype.changeListenersRecordConstructor=RangeChangeListenersRecord;RangeChangeDescriptor.prototype.willChangeListenersRecordConstructor=RangeWillChangeListenersRecord;Object.defineProperty(RangeChangeDescriptor.prototype,"active",{get:function(){return this._active||(this._active=this._current?this._current.slice():[])}});var RangeChangeListenersSpecificHandlerMethodName=new Map;function RangeChangeListenersRecord(name){var specificHandlerMethodName=RangeChangeListenersSpecificHandlerMethodName.get(name);if(!specificHandlerMethodName){specificHandlerMethodName="handle";specificHandlerMethodName+=name.slice(0,1).toUpperCase();specificHandlerMethodName+=name.slice(1);specificHandlerMethodName+="RangeChange";RangeChangeListenersSpecificHandlerMethodName.set(name,specificHandlerMethodName)}this.specificHandlerMethodName=specificHandlerMethodName;return this}RangeChangeListenersRecord.prototype=new ChangeListenersRecord;RangeChangeListenersRecord.prototype.constructor=RangeChangeListenersRecord;var RangeWillChangeListenersSpecificHandlerMethodName=new Map;function RangeWillChangeListenersRecord(name){var specificHandlerMethodName=RangeWillChangeListenersSpecificHandlerMethodName.get(name);if(!specificHandlerMethodName){specificHandlerMethodName="handle";specificHandlerMethodName+=name.slice(0,1).toUpperCase();specificHandlerMethodName+=name.slice(1);specificHandlerMethodName+="RangeWillChange";RangeWillChangeListenersSpecificHandlerMethodName.set(name,specificHandlerMethodName)}this.specificHandlerMethodName=specificHandlerMethodName;return this}RangeWillChangeListenersRecord.prototype=new ChangeListenersRecord;RangeWillChangeListenersRecord.prototype.constructor=RangeWillChangeListenersRecord;module.exports=RangeChanges;function RangeChanges(){throw new Error("Can't construct. RangeChanges is a mixin.")}RangeChanges.prototype.getAllRangeChangeDescriptors=function(){if(!rangeChangeDescriptors.has(this)){rangeChangeDescriptors.set(this,new Map)}return rangeChangeDescriptors.get(this)};RangeChanges.prototype.getRangeChangeDescriptor=function(token){var tokenChangeDescriptors=this.getAllRangeChangeDescriptors();token=token||"";if(!tokenChangeDescriptors.has(token)){tokenChangeDescriptors.set(token,new RangeChangeDescriptor(token))}return tokenChangeDescriptors.get(token)};var ObjectsDispatchesRangeChanges=new WeakMap,dispatchesRangeChangesGetter=function(){return ObjectsDispatchesRangeChanges.get(this)},dispatchesRangeChangesSetter=function(value){return ObjectsDispatchesRangeChanges.set(this,value)},dispatchesChangesMethodName="dispatchesRangeChanges",dispatchesChangesPropertyDescriptor={get:dispatchesRangeChangesGetter,set:dispatchesRangeChangesSetter,configurable:true,enumerable:false};RangeChanges.prototype.addRangeChangeListener=function addRangeChangeListener(listener,token,beforeChange){if(!this.isObservable&&this.makeObservable){this.makeObservable()}var descriptor=this.getRangeChangeDescriptor(token);var listeners;if(beforeChange){listeners=descriptor.willChangeListeners}else{listeners=descriptor.changeListeners}if(!listeners._current){listeners._current=listener}else if(!Array.isArray(listeners._current)){listeners._current=[listeners._current,listener]}else{listeners._current.push(listener)}if(Object.getOwnPropertyDescriptor(this.__proto__||Object.getPrototypeOf(this),dispatchesChangesMethodName)===void 0){Object.defineProperty(this.__proto__||Object.getPrototypeOf(this),dispatchesChangesMethodName,dispatchesChangesPropertyDescriptor)}this.dispatchesRangeChanges=true;var self=this;return function cancelRangeChangeListener(){if(!self){return}self.removeRangeChangeListener(listener,token,beforeChange);self=null}};RangeChanges.prototype.removeRangeChangeListener=function(listener,token,beforeChange){var descriptor=this.getRangeChangeDescriptor(token);var listeners;if(beforeChange){listeners=descriptor._willChangeListeners}else{listeners=descriptor._changeListeners}if(listeners._current){if(listeners._current===listener){listeners._current=null}else{var index=listeners._current.lastIndexOf(listener);if(index===-1){throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(token))}else{if(descriptor.isActive){listeners.ghostCount=listeners.ghostCount+1;listeners._current[index]=ListenerGhost}else{listeners._current.spliceOne(index)}}}}};RangeChanges.prototype.dispatchRangeChange=function(plus,minus,index,beforeChange){var descriptors=this.getAllRangeChangeDescriptors();descriptors.dispatchBeforeChange=beforeChange;descriptors.forEach(function(descriptor,token,descriptors){if(descriptor.isActive){return}var listeners=beforeChange?descriptor._willChangeListeners:descriptor._changeListeners;if(listeners&&listeners._current){var tokenName=listeners.specificHandlerMethodName;if(Array.isArray(listeners._current)){if(listeners._current.length){descriptor.isActive=true;try{var i,countI,listener,currentListeners=listeners.removeCurrentGostListenersIfNeeded(),Ghost=ListenerGhost;for(i=0,countI=currentListeners.length;i<countI;i++){if((listener=currentListeners[i])!==Ghost){if(listener[tokenName]){listener[tokenName](plus,minus,index,this,beforeChange)}else if(listener.call){listener.call(this,plus,minus,index,this,beforeChange)}else{throw new Error("Handler "+listener+" has no method "+tokenName+" and is not callable")}}}}finally{descriptor.isActive=false}}}else{descriptor.isActive=true;try{listener=listeners._current;if(listener[tokenName]){listener[tokenName](plus,minus,index,this,beforeChange)}else if(listener.call){listener.call(this,plus,minus,index,this,beforeChange)}else{throw new Error("Handler "+listener+" has no method "+tokenName+" and is not callable")}}finally{descriptor.isActive=false}}}},this)};RangeChanges.prototype.addBeforeRangeChangeListener=function(listener,token){return this.addRangeChangeListener(listener,token,true)};RangeChanges.prototype.removeBeforeRangeChangeListener=function(listener,token){return this.removeRangeChangeListener(listener,token,true)};RangeChanges.prototype.dispatchBeforeRangeChange=function(plus,minus,index){return this.dispatchRangeChange(plus,minus,index,true)}},{"../_map":18,"./change-descriptor":25,"weak-map":36}],28:[function(require,module,exports){"use strict";var Function=require("./shim-function");var GenericCollection=require("./generic-collection");var GenericOrder=require("./generic-order");var WeakMap=require("weak-map");module.exports=Array;var array_splice=Array.prototype.splice;var array_slice=Array.prototype.slice;Array.empty=[];if(Object.freeze){Object.freeze(Array.empty)}Array.from=function(values){var array=[];array.addEach(values);return array};Array.unzip=function(table){var transpose=[];var length=Infinity;for(var i=0;i<table.length;i++){var row=table[i];table[i]=row.toArray();if(row.length<length){length=row.length}}for(var i=0;i<table.length;i++){var row=table[i];for(var j=0;j<row.length;j++){if(j<length&&j in row){transpose[j]=transpose[j]||[];transpose[j][i]=row[j]}}}return transpose};function define(key,value){Object.defineProperty(Array.prototype,key,{value:value,writable:true,configurable:true,enumerable:false})}define("addEach",GenericCollection.prototype.addEach);define("deleteEach",GenericCollection.prototype.deleteEach);define("toArray",GenericCollection.prototype.toArray);define("toObject",GenericCollection.prototype.toObject);define("all",GenericCollection.prototype.all);define("any",GenericCollection.prototype.any);define("min",GenericCollection.prototype.min);define("max",GenericCollection.prototype.max);define("sum",GenericCollection.prototype.sum);define("average",GenericCollection.prototype.average);define("only",GenericCollection.prototype.only);define("flatten",GenericCollection.prototype.flatten);define("zip",GenericCollection.prototype.zip);define("enumerate",GenericCollection.prototype.enumerate);define("group",GenericCollection.prototype.group);define("sorted",GenericCollection.prototype.sorted);define("reversed",GenericCollection.prototype.reversed);define("constructClone",function(values){var clone=new this.constructor;clone.addEach(values);return clone});define("has",function(value,equals){return this.find(value,equals)!==-1});define("get",function(index,defaultValue){if(+index!==index)throw new Error("Indicies must be numbers");if(!index in this){return defaultValue}else{return this[index]}});define("set",function(index,value){this[index]=value;return true});define("add",function(value){this.push(value);return true});define("delete",function(value,equals){var index=this.find(value,equals);if(index!==-1){this.spliceOne(index);return true}return false});define("deleteAll",function(value,equals){equals=equals||this.contentEquals||Object.equals;var count=0;for(var index=0;index<this.length;){if(equals(value,this[index])){this.swap(index,1);count++}else{index++}}return count});define("find",function(value,equals){equals=equals||this.contentEquals||Object.equals;for(var index=0;index<this.length;index++){if(index in this&&equals(value,this[index])){return index}}return-1});define("findLast",function(value,equals){equals=equals||this.contentEquals||Object.equals;var index=this.length;do{index--;if(index in this&&equals(this[index],value)){return index}}while(index>0);return-1});define("swap",function(start,length,plus){var args,plusLength,i,j,returnValue;if(start>this.length){this.length=start}if(typeof plus!=="undefined"){args=[start,length];if(!Array.isArray(plus)){plus=array_slice.call(plus)}i=0;plusLength=plus.length;if(plusLength<1e3){for(i;i<plusLength;i++){args[i+2]=plus[i]}return array_splice.apply(this,args)}else{returnValue=array_splice.apply(this,args);for(i;i<plusLength;){args=[start+i,0];for(j=2;j<1002&&i<plusLength;j++,i++){args[j]=plus[i]}array_splice.apply(this,args)}return returnValue}}else if(typeof length!=="undefined"){return array_splice.call(this,start,length)}else if(typeof start!=="undefined"){return array_splice.call(this,start)}else{return[]}});define("peek",function(){return this[0]});define("poke",function(value){if(this.length>0){this[0]=value}});define("peekBack",function(){if(this.length>0){return this[this.length-1]}});define("pokeBack",function(value){if(this.length>0){this[this.length-1]=value}});define("one",function(){for(var i in this){if(Object.owns(this,i)){return this[i]}}});if(!Array.prototype.clear){define("clear",function(){this.length=0;return this})}define("compare",function(that,compare){compare=compare||Object.compare;var i;var length;var lhs;var rhs;var relative;if(this===that){return 0}if(!that||!Array.isArray(that)){return GenericOrder.prototype.compare.call(this,that,compare)}length=this.length<that.length?this.length:that.length;for(i=0;i<length;i++){if(i in this){if(!(i in that)){return-1}else{lhs=this[i];rhs=that[i];relative=compare(lhs,rhs);if(relative){return relative}}}else if(i in that){return 1}}return this.length-that.length});define("equals",function(that,equals){equals=equals||Object.equals;var i=0;var length=this.length;var left;var right;if(this===that){return true}if(!that||!Array.isArray(that)){return GenericOrder.prototype.equals.call(this,that)}if(length!==that.length){return false}else{for(;i<length;++i){if(i in this){if(!(i in that)){return false}left=this[i];right=that[i];if(!equals(left,right)){return false}}else{if(i in that){return false}}}}return true});define("clone",function(depth,memo){if(depth==null){depth=Infinity}else if(depth===0){return this}memo=memo||new WeakMap;if(memo.has(this)){return memo.get(this)}var clone=new Array(this.length);memo.set(this,clone);for(var i in this){clone[i]=Object.clone(this[i],depth-1,memo)}return clone});define("iterate",function(start,end){return new ArrayIterator(this,start,end)});if(Array.prototype.spliceOne===void 0){define("spliceOne",function(index,itemToAdd){var len=this.length;if(!len){return}if(arguments.length===1){while(index<len){this[index]=this[index+1];index++}this.length--}else{this[index]=itemToAdd}})}define("Iterator",ArrayIterator);function ArrayIterator(array,start,end){this.array=array;this.start=start==null?0:start;this.end=end}ArrayIterator.prototype.__iterationObject=null;Object.defineProperty(ArrayIterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:false,value:null})}});ArrayIterator.prototype.next=function(){if(this.start===(this.end==null?this.array.length:this.end)){this._iterationObject.done=true;this._iterationObject.value=void 0}else{this._iterationObject.value=this.array[this.start++]}return this._iterationObject}},{"./generic-collection":20,"./generic-order":22,"./shim-function":29,"weak-map":36}],29:[function(require,module,exports){module.exports=Function;Function.noop=function(){};Function.identity=function(value){return value};Function.by=function(by,compare){compare=compare||Object.compare;by=by||Function.identity;var compareBy=function(a,b){return compare(by(a),by(b))};compareBy.compare=compare;compareBy.by=by;return compareBy};Function.get=function(key){return function(object){return Object.get(object,key)}}},{}],30:[function(require,module,exports){"use strict";var WeakMap=require("weak-map");module.exports=Object;Object.empty=Object.freeze(Object.create(null));Object.isObject=function(object){return Object(object)===object};Object.getValueOf=function(value){if(value&&typeof value.valueOf==="function"){value=value.valueOf()}return value};var hashMap=new WeakMap;Object.hash=function(object){if(object&&typeof object.hash==="function"){return""+object.hash()}else if(Object(object)===object){if(!hashMap.has(object)){hashMap.set(object,Math.random().toString(36).slice(2))}return hashMap.get(object)}else{return""+object}};var owns=Object.prototype.hasOwnProperty;Object.owns=function(object,key){return owns.call(object,key)};Object.has=function(object,key){if(typeof object!=="object"){throw new Error("Object.has can't accept non-object: "+typeof object)}if(object&&typeof object.has==="function"){return object.has(key)}else if(typeof key==="string"){return key in object&&object[key]!==Object.prototype[key]}else{throw new Error("Key must be a string for Object.has on plain objects")}};Object.get=function(object,key,value){if(typeof object!=="object"){throw new Error("Object.get can't accept non-object: "+typeof object)}if(object&&typeof object.get==="function"){return object.get(key,value)}else if(Object.has(object,key)){return object[key]}else{return value}};Object.set=function(object,key,value){if(object&&typeof object.set==="function"){object.set(key,value)}else{object[key]=value}};Object.addEach=function(target,source,overrides){var overridesExistingProperty=arguments.length===3?overrides:true;if(!source){}else if(typeof source.forEach==="function"&&!source.hasOwnProperty("forEach")){if(source.isMap===true){source.forEach(function(value,key){target[key]=value})}else{source.forEach(function(pair){target[pair[0]]=pair[1]})}}else if(typeof source.length==="number"){for(var index=0;index<source.length;index++){target[index]=source[index]}}else{for(var keys=Object.keys(source),i=0,key;key=keys[i];i++){if(overridesExistingProperty||!Object.owns(target,key)){target[key]=source[key]}}}return target};Object.defineEach=function(target,source,overrides,configurable,enumerable,writable){var overridesExistingProperty=arguments.length===3?overrides:true;if(!source){}else if(typeof source.forEach==="function"&&!source.hasOwnProperty("forEach")){if(source.isMap===true){source.forEach(function(value,key){Object.defineProperty(target,key,{value:value,writable:writable,configurable:configurable,enumerable:enumerable})})}else{source.forEach(function(pair){Object.defineProperty(target,pair[0],{value:pair[1],writable:writable,configurable:configurable,enumerable:enumerable})})}}else if(typeof source.length==="number"){for(var index=0;index<source.length;index++){Object.defineProperty(target,index,{value:source[index],writable:writable,configurable:configurable,enumerable:enumerable})}}else{for(var keys=Object.keys(source),i=0,key;key=keys[i];i++){if(overridesExistingProperty||!Object.owns(target,key)){Object.defineProperty(target,key,{value:source[key],writable:writable,configurable:configurable,enumerable:enumerable})}}}return target};Object.forEach=function(object,callback,thisp){var keys=Object.keys(object),i=0,iKey;for(;iKey=keys[i];i++){callback.call(thisp,object[iKey],iKey,object)}};Object.map=function(object,callback,thisp){var keys=Object.keys(object),i=0,result=[],iKey;for(;iKey=keys[i];i++){result.push(callback.call(thisp,object[iKey],iKey,object))}return result};Object.values=function(object){return Object.map(object,Function.identity)};Object.concat=function(){var object={};for(var i=0;i<arguments.length;i++){Object.addEach(object,arguments[i])}return object};Object.from=Object.concat;Object.is=function(x,y){if(x===y){return x!==0||1/x===1/y}return x!==x&&y!==y};Object.equals=function(a,b,equals,memo){equals=equals||Object.equals;a=Object.getValueOf(a);b=Object.getValueOf(b);if(a===b)return true;if(Object.isObject(a)){memo=memo||new WeakMap;if(memo.has(a)){return true}memo.set(a,true)}if(Object.isObject(a)&&typeof a.equals==="function"){return a.equals(b,equals,memo)}if(Object.isObject(b)&&typeof b.equals==="function"){return b.equals(a,equals,memo)}if(Object.isObject(a)&&Object.isObject(b)){if(Object.getPrototypeOf(a)===Object.prototype&&Object.getPrototypeOf(b)===Object.prototype){for(var name in a){if(!equals(a[name],b[name],equals,memo)){return false}}for(var name in b){if(!(name in a)||!equals(b[name],a[name],equals,memo)){return false}}return true}}if(a!==a&&b!==b)return true;if(!a||!b)return a===b;return false};Object.compare=function(a,b){a=Object.getValueOf(a);b=Object.getValueOf(b);if(a===b)return 0;var aType=typeof a;var bType=typeof b;if(aType==="number"&&bType==="number")return a-b;if(aType==="string"&&bType==="string")return a<b?-Infinity:Infinity;if(a&&typeof a.compare==="function")return a.compare(b);if(b&&typeof b.compare==="function")return-b.compare(a);return 0};Object.clone=function(value,depth,memo){value=Object.getValueOf(value);memo=memo||new WeakMap;if(depth===undefined){depth=Infinity}else if(depth===0){return value}if(Object.isObject(value)){if(!memo.has(value)){if(value&&typeof value.clone==="function"){memo.set(value,value.clone(depth,memo))}else{var prototype=Object.getPrototypeOf(value);if(prototype===null||prototype===Object.prototype){var clone=Object.create(prototype);memo.set(value,clone);for(var key in value){clone[key]=Object.clone(value[key],depth-1,memo)}}else{throw new Error("Can't clone "+value)}}}return memo.get(value)}return value};Object.clear=function(object){if(object&&typeof object.clear==="function"){object.clear()}else{var keys=Object.keys(object),i=keys.length;while(i){i--;delete object[keys[i]]}}return object}},{"weak-map":36}],31:[function(require,module,exports){if(!RegExp.escape){var special=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(string){return string.replace(special,"\\$&")}}},{}],32:[function(require,module,exports){var Array=require("./shim-array");var Object=require("./shim-object");var Function=require("./shim-function");var RegExp=require("./shim-regexp")},{"./shim-array":28,"./shim-function":29,"./shim-object":30,"./shim-regexp":31}],33:[function(require,module,exports){"use strict";module.exports=SortedArray;var Shim=require("./shim");var GenericCollection=require("./generic-collection");var PropertyChanges=require("./listen/property-changes");var RangeChanges=require("./listen/range-changes");function SortedArray(values,equals,compare,getDefault){if(!(this instanceof SortedArray)){return new SortedArray(values,equals,compare,getDefault)}if(Array.isArray(values)){this.array=values;values=values.splice(0,values.length)}else{this.array=[]}this.contentEquals=equals||Object.equals;this.contentCompare=compare||Object.compare;this.getDefault=getDefault||Function.noop;this.length=0;this.addEach(values)}SortedArray.SortedArray=SortedArray;SortedArray.from=GenericCollection.from;Object.addEach(SortedArray.prototype,GenericCollection.prototype);Object.addEach(SortedArray.prototype,PropertyChanges.prototype);Object.addEach(SortedArray.prototype,RangeChanges.prototype);SortedArray.prototype.isSorted=true;function search(array,value,compare){var first=0;var last=array.length-1;while(first<=last){var middle=first+last>>1;var comparison=compare(value,array[middle]);if(comparison>0){first=middle+1}else if(comparison<0){last=middle-1}else{return middle}}return-(first+1)}function searchFirst(array,value,compare,equals){var index=search(array,value,compare);if(index<0){return-1}else{while(index>0&&equals(value,array[index-1])){index--}if(!equals(value,array[index])){return-1}else{return index}}}function searchLast(array,value,compare,equals){var index=search(array,value,compare);if(index<0){return-1}else{while(index<array.length-1&&equals(value,array[index+1])){index++}if(!equals(value,array[index])){return-1}else{return index}}}function searchForInsertionIndex(array,value,compare){var index=search(array,value,compare);if(index<0){return-index-1}else{var last=array.length-1;while(index<last&&compare(value,array[index+1])===0){index++}return index}}SortedArray.prototype.constructClone=function(values){
return new this.constructor(values,this.contentEquals,this.contentCompare,this.getDefault)};SortedArray.prototype.has=function(value,equals){if(equals){throw new Error("SortedSet#has does not support second argument: equals")}var index=search(this.array,value,this.contentCompare);return index>=0&&this.contentEquals(this.array[index],value)};SortedArray.prototype.get=function(value,equals){if(equals){throw new Error("SortedArray#get does not support second argument: equals")}var index=searchFirst(this.array,value,this.contentCompare,this.contentEquals);if(index!==-1){return this.array[index]}else{return this.getDefault(value)}};SortedArray.prototype.add=function(value){var index=searchForInsertionIndex(this.array,value,this.contentCompare);if(this.dispatchesRangeChanges){this.dispatchBeforeRangeChange([value],Array.empty,index)}this.array.splice(index,0,value);this.length++;if(this.dispatchesRangeChanges){this.dispatchRangeChange([value],Array.empty,index)}return true};SortedArray.prototype["delete"]=function(value,equals){if(equals){throw new Error("SortedArray#delete does not support second argument: equals")}var index=searchFirst(this.array,value,this.contentCompare,this.contentEquals);if(index!==-1){if(this.dispatchesRangeChanges){this.dispatchBeforeRangeChange(Array.empty,[value],index)}this.array.spliceOne(index);this.length--;if(this.dispatchesRangeChanges){this.dispatchRangeChange(Array.empty,[value],index)}return true}else{return false}};SortedArray.prototype.deleteAll=function(value,equals){if(equals){var count=this.array.deleteAll(value,equals);this.length-=count;return count}else{var start=searchFirst(this.array,value,this.contentCompare,this.contentEquals);if(start!==-1){var end=start;while(this.contentEquals(value,this.array[end])){end++}var minus=this.slice(start,end);if(this.dispatchesRangeChanges){this.dispatchBeforeRangeChange(Array.empty,minus,start)}this.array.splice(start,minus.length);this.length-=minus.length;if(this.dispatchesRangeChanges){this.dispatchRangeChange(Array.empty,minus,start)}return minus.length}else{return 0}}};SortedArray.prototype.indexOf=function(value){return searchFirst(this.array,value,this.contentCompare,this.contentEquals)};SortedArray.prototype.lastIndexOf=function(value){return searchLast(this.array,value,this.contentCompare,this.contentEquals)};SortedArray.prototype.find=function(value,equals,index){if(equals){throw new Error("SortedArray#find does not support second argument: equals")}if(index){throw new Error("SortedArray#find does not support third argument: index")}return searchFirst(this.array,value,this.contentCompare,this.contentEquals)};SortedArray.prototype.findLast=function(value,equals,index){if(equals){throw new Error("SortedArray#findLast does not support second argument: equals")}if(index){throw new Error("SortedArray#findLast does not support third argument: index")}return searchLast(this.array,value,this.contentCompare,this.contentEquals)};SortedArray.prototype.push=function(){this.addEach(arguments)};SortedArray.prototype.unshift=function(){this.addEach(arguments)};SortedArray.prototype.pop=function(){var val=this.array.pop();this.length=this.array.length;return val};SortedArray.prototype.shift=function(){var val=this.array.shift();this.length=this.array.length;return val};SortedArray.prototype.slice=function(){return this.array.slice.apply(this.array,arguments)};SortedArray.prototype.splice=function(index,length){return this.swap(index,length,Array.prototype.slice.call(arguments,2))};SortedArray.prototype.swap=function(index,length,plus){if(index===undefined&&length===undefined){return Array.empty}index=index||0;if(index<0){index+=this.length}if(length===undefined){length=Infinity}var minus=this.slice(index,index+length);if(this.dispatchesRangeChanges){this.dispatchBeforeRangeChange(plus,minus,index)}this.array.splice(index,length);this.length-=minus.length;if(this.dispatchesRangeChanges){this.dispatchRangeChange(Array.empty,minus,index)}this.addEach(plus);return minus};SortedArray.prototype.reduce=function(callback,basis){var thisp=arguments[2];return this.array.reduce(function(basis,value,key){return callback.call(thisp,basis,value,key,this)},basis,this)};SortedArray.prototype.reduceRight=function(){var thisp=arguments[2];return this.array.reduceRight(function(basis,value,key){return callback.call(thisp,basis,value,key,this)},basis,this)};SortedArray.prototype.min=function(){if(this.length){return this.array[0]}};SortedArray.prototype.max=function(){if(this.length){return this.array[this.length-1]}};SortedArray.prototype.one=function(){return this.array.one()};SortedArray.prototype.clear=function(){var minus;if(this.dispatchesRangeChanges){minus=this.array.slice();this.dispatchBeforeRangeChange(Array.empty,minus,0)}this.length=0;this.array.clear();if(this.dispatchesRangeChanges){this.dispatchRangeChange(Array.empty,minus,0)}};SortedArray.prototype.equals=function(that,equals){return this.array.equals(that,equals)};SortedArray.prototype.compare=function(that,compare){return this.array.compare(that,compare)};SortedArray.prototype.iterate=function(start,end){return new this.Iterator(this.array,start,end)};SortedArray.prototype.toJSON=function(){return this.toArray()};SortedArray.prototype.Iterator=Array.prototype.Iterator},{"./generic-collection":20,"./listen/property-changes":26,"./listen/range-changes":27,"./shim":32}],34:[function(require,module,exports){"use strict";module.exports=TreeLog;function TreeLog(){}TreeLog.ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"};TreeLog.unicodeRound={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""};TreeLog.unicodeSharp={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""}},{}],35:[function(require,module,exports){(function(global){module.exports=global.WeakMap!==void 0?global.WeakMap:require("weak-map")}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"weak-map":36}],36:[function(require,module,exports){(function WeakMapModule(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function weakMapPermitHostObjects(map){if(map.permitHostObjects___){map.permitHostObjects___(weakMapPermitHostObjects)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=weakMapPermitHostObjects}var doubleWeakMapCheckSilentFailure=false;if(typeof WeakMap==="function"){var HostWeakMap=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var testMap=new HostWeakMap;var testObject=Object.freeze({});testMap.set(testObject,1);if(testMap.get(testObject)!==1){doubleWeakMapCheckSilentFailure=true}else{module.exports=WeakMap;return}}}var hop=Object.prototype.hasOwnProperty;var gopn=Object.getOwnPropertyNames;var defProp=Object.defineProperty;var isExtensible=Object.isExtensible;var HIDDEN_NAME_PREFIX="weakmap:";var HIDDEN_NAME=HIDDEN_NAME_PREFIX+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var ab=new ArrayBuffer(25);var u8s=new Uint8Array(ab);crypto.getRandomValues(u8s);HIDDEN_NAME=HIDDEN_NAME_PREFIX+"rand:"+Array.prototype.map.call(u8s,function(u8){return(u8%36).toString(36)}).join("")+"___"}function isNotHiddenName(name){return!(name.substr(0,HIDDEN_NAME_PREFIX.length)==HIDDEN_NAME_PREFIX&&name.substr(name.length-3)==="___")}defProp(Object,"getOwnPropertyNames",{value:function fakeGetOwnPropertyNames(obj){return gopn(obj).filter(isNotHiddenName)}});if("getPropertyNames"in Object){var originalGetPropertyNames=Object.getPropertyNames;defProp(Object,"getPropertyNames",{value:function fakeGetPropertyNames(obj){return originalGetPropertyNames(obj).filter(isNotHiddenName)}})}function getHiddenRecord(key){if(key!==Object(key)){throw new TypeError("Not an object: "+key)}var hiddenRecord=key[HIDDEN_NAME];if(hiddenRecord&&hiddenRecord.key===key){return hiddenRecord}if(!isExtensible(key)){return void 0}hiddenRecord={key:key};try{defProp(key,HIDDEN_NAME,{value:hiddenRecord,writable:false,enumerable:false,configurable:false});return hiddenRecord}catch(error){return void 0}}(function(){var oldFreeze=Object.freeze;defProp(Object,"freeze",{value:function identifyingFreeze(obj){getHiddenRecord(obj);return oldFreeze(obj)}});var oldSeal=Object.seal;defProp(Object,"seal",{value:function identifyingSeal(obj){getHiddenRecord(obj);return oldSeal(obj)}});var oldPreventExtensions=Object.preventExtensions;defProp(Object,"preventExtensions",{value:function identifyingPreventExtensions(obj){getHiddenRecord(obj);return oldPreventExtensions(obj)}})})();function constFunc(func){func.prototype=null;return Object.freeze(func)}var calledAsFunctionWarningDone=false;function calledAsFunctionWarning(){if(!calledAsFunctionWarningDone&&typeof console!=="undefined"){calledAsFunctionWarningDone=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var nextId=0;var OurWeakMap=function(){if(!(this instanceof OurWeakMap)){calledAsFunctionWarning()}var keys=[];var values=[];var id=nextId++;function get___(key,opt_default){var index;var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){return id in hiddenRecord?hiddenRecord[id]:opt_default}else{index=keys.indexOf(key);return index>=0?values[index]:opt_default}}function has___(key){var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){return id in hiddenRecord}else{return keys.indexOf(key)>=0}}function set___(key,value){var index;var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){hiddenRecord[id]=value}else{index=keys.indexOf(key);if(index>=0){values[index]=value}else{index=keys.length;values[index]=value;keys[index]=key}}return this}function delete___(key){var hiddenRecord=getHiddenRecord(key);var index,lastIndex;if(hiddenRecord){return id in hiddenRecord&&delete hiddenRecord[id]}else{index=keys.indexOf(key);if(index<0){return false}lastIndex=keys.length-1;keys[index]=void 0;values[index]=values[lastIndex];keys[index]=keys[lastIndex];keys.length=lastIndex;values.length=lastIndex;return true}}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(get___)},has___:{value:constFunc(has___)},set___:{value:constFunc(set___)},delete___:{value:constFunc(delete___)}})};OurWeakMap.prototype=Object.create(Object.prototype,{get:{value:function get(key,opt_default){return this.get___(key,opt_default)},writable:true,configurable:true},has:{value:function has(key){return this.has___(key)},writable:true,configurable:true},set:{value:function set(key,value){return this.set___(key,value)},writable:true,configurable:true},delete:{value:function remove(key){return this.delete___(key)},writable:true,configurable:true}});if(typeof HostWeakMap==="function"){(function(){if(doubleWeakMapCheckSilentFailure&&typeof Proxy!=="undefined"){Proxy=undefined}function DoubleWeakMap(){if(!(this instanceof OurWeakMap)){calledAsFunctionWarning()}var hmap=new HostWeakMap;var omap=undefined;var enableSwitching=false;function dget(key,opt_default){if(omap){return hmap.has(key)?hmap.get(key):omap.get___(key,opt_default)}else{return hmap.get(key,opt_default)}}function dhas(key){return hmap.has(key)||(omap?omap.has___(key):false)}var dset;if(doubleWeakMapCheckSilentFailure){dset=function(key,value){hmap.set(key,value);if(!hmap.has(key)){if(!omap){omap=new OurWeakMap}omap.set(key,value)}return this}}else{dset=function(key,value){if(enableSwitching){try{hmap.set(key,value)}catch(e){if(!omap){omap=new OurWeakMap}omap.set___(key,value)}}else{hmap.set(key,value)}return this}}function ddelete(key){var result=!!hmap["delete"](key);if(omap){return omap.delete___(key)||result}return result}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(dget)},has___:{value:constFunc(dhas)},set___:{value:constFunc(dset)},delete___:{value:constFunc(ddelete)},permitHostObjects___:{value:constFunc(function(token){if(token===weakMapPermitHostObjects){enableSwitching=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}DoubleWeakMap.prototype=OurWeakMap.prototype;module.exports=DoubleWeakMap;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}module.exports=OurWeakMap}})()},{}]},{},[2])(2)});